

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. System Configuration &mdash; METplus 3.1 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://dtcenter.github.io/METplus/latest/Users_Guide/systemconfiguration.html"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="METplus 3.1 documentation" href="../index.html"/>
        <link rel="up" title="User’s Guide" href="index.html"/>
        <link rel="next" title="4. Python Wrappers" href="wrappers.html"/>
        <link rel="prev" title="2. Software Installation/Getting Started" href="installation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> METplus
          

          
            
            <img src="../_static/METplus_logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  3.1
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">METplus Wrappers Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">2. Software Installation/Getting Started</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. System Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#config-best-practices">3.1. Config Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-file-structure">3.2. Config File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#common-config-variables">3.3. Common Config Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#timing-control">3.3.1. Timing Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loop-order">3.3.2. Loop Order</a></li>
<li class="toctree-l4"><a class="reference internal" href="#custom-looping">3.3.3. Custom Looping</a></li>
<li class="toctree-l4"><a class="reference internal" href="#field-info">3.3.4. Field Info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#directory-and-filename-template-info">3.3.5. Directory and Filename Template Info</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#config-quick-start-example">3.4. Config Quick Start Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-defined-config">3.5. User Defined Config</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wrappers.html">4. Python Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="usecases.html">5. METplus Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html">6. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="quicksearch.html">7. METplus Quick Search for Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">8. METplus Configuration Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Contributors_Guide/index.html">Contributor’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METplus</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User’s Guide</a> &raquo;</li>
        
      <li><span class="section-number">3. </span>System Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Users_Guide/systemconfiguration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="system-configuration">
<span id="sysconf"></span><h1><span class="section-number">3. </span>System Configuration<a class="headerlink" href="#system-configuration" title="Permalink to this headline">¶</a></h1>
<p>This chapter is a guide on configuring METplus Wrappers.</p>
<div class="section" id="config-best-practices">
<h2><span class="section-number">3.1. </span>Config Best Practices<a class="headerlink" href="#config-best-practices" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Set your log level to an appropriate level:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Debug is the most verbose and is useful when you are troubleshooting problems</p></li>
<li><p>Info is the default level</p></li>
<li><p>Warning only logs warnings, error, or critical events</p></li>
<li><p>Error only logs errors or critical events</p></li>
<li><p>Critical is the least verbose and is rarely used</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Log output will be written to a log file as well as shown on the screen. Reviewing the log files to verify that all your processes ran cleanly is recommended, as they contain more information that what is output in the terminal, such as log output from the MET tools.</p></li>
<li><p>The order in which you list your METplus wrapper config files matters. Each subsequent config file on the command line will override any values defined in an earlier config file. It is recommended to put user-specific configurations, like OUTPUT_BASE, in its own configuration file to be read in last in case any information configurations are accidentally defined in multiple conf files.</p></li>
<li><p>Check the metplus_final.conf file (found in the top level of OUTPUT_BASE) to verify that you have defined things as you expected, as it contains all the key-values that you have specified.</p></li>
</ol>
</div>
<div class="section" id="config-file-structure">
<h2><span class="section-number">3.2. </span>Config File Structure<a class="headerlink" href="#config-file-structure" title="Permalink to this headline">¶</a></h2>
<p>METplus Wrappers employs a hierarchy of configuration files employed in METplus Wrappers. At the lowest level are the “set-and-forget” type configuration files that reside in the <em>&lt;METplus_installation_dir&gt;/parm/metplus_config</em>. At the next level are the configuration files that pertain to a user’s specific needs in the <em>&lt;METplus_installation_dir&gt;/parm/use_cases/&lt;specific_use_case&gt;</em>.</p>
<p>Four configuration files are required for METplus Wrappers to be fully configured (i.e. all keywords are defined by either whitespace or a valid value):</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>metplus_system</p></li>
<li><p>metplus_data</p></li>
<li><p>metplus_logging</p></li>
<li><p>metplus_runtime</p></li>
</ol>
</div></blockquote>
<p>By default, key-values that require the user’s input are set to <em>&lt;/path/to&gt;</em>. Make sure to replace these with the appropriate directory for your project.</p>
<p>Additional configuration files are optional and the key-values defined there will override any values defined in the four mandatory METplus Wrappers configuration files. These additional configuration files enable users to use a common set of configuration files and to create customized environments for their verification tasks.</p>
</div>
<div class="section" id="common-config-variables">
<h2><span class="section-number">3.3. </span>Common Config Variables<a class="headerlink" href="#common-config-variables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="timing-control">
<h3><span class="section-number">3.3.1. </span>Timing Control<a class="headerlink" href="#timing-control" title="Permalink to this headline">¶</a></h3>
<p>This section describes the METplus wrapper configuration variables that are used to control which times are processed. It also covers functionality that is useful for processing data in realtime by setting run times based on the clock time when the METplus wrappers are run.</p>
<div class="section" id="loop-by">
<span id="loop-by-ref"></span><h4><span class="section-number">3.3.1.1. </span><a class="reference internal" href="glossary.html#term-LOOP_BY"><span class="xref std std-term">LOOP_BY</span></a><a class="headerlink" href="#loop-by" title="Permalink to this headline">¶</a></h4>
<p>The METplus wrappers can be configured to loop over a set of valid times or a set of initialization times. This is controlled by the configuration variable called <a class="reference internal" href="glossary.html#term-LOOP_BY"><span class="xref std std-term">LOOP_BY</span></a>. If the value of this variable is set to INIT or RETRO, looping will be relative to initialization time. If the value is set to VALID or REALTIME, looping will be relative to valid time.</p>
</div>
<div class="section" id="looping-by-valid-time">
<span id="id1"></span><h4><span class="section-number">3.3.1.2. </span>Looping by Valid Time<a class="headerlink" href="#looping-by-valid-time" title="Permalink to this headline">¶</a></h4>
<p>When looping over valid time (<cite>LOOP_BY</cite> = VALID or REALTIME), the following variables must be set:</p>
<p><a class="reference internal" href="glossary.html#term-VALID_TIME_FMT"><span class="xref std std-term">VALID_TIME_FMT</span></a>:
This is the format of the valid times the user can configure in the METplus Wrappers. The value of <cite>VALID_BEG</cite> and <cite>VALID_END</cite> must correspond to this format.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VALID_TIME_FMT</span> <span class="o">=</span> <span class="o">%</span><span class="n">Y</span><span class="o">%</span><span class="n">m</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">H</span>
</pre></div>
</div>
<p>Using this format, the valid time range values specified must be defined as YYYYMMDDHH, i.e. 2019020112.</p>
<p><a class="reference internal" href="glossary.html#term-VALID_BEG"><span class="xref std std-term">VALID_BEG</span></a>:
This is the first valid time that will be processed. The format of this variable is controlled by <a class="reference internal" href="glossary.html#term-VALID_TIME_FMT"><span class="xref std std-term">VALID_TIME_FMT</span></a>. For example, if VALID_TIME_FMT=%Y%m%d, then VALID_BEG must be set to a valid time matching YYYYMMDD, such as 20190201.</p>
<p><a class="reference internal" href="glossary.html#term-VALID_END"><span class="xref std std-term">VALID_END</span></a>:
This is the last valid time that can be processed. The format of this variable is controlled by <a class="reference internal" href="glossary.html#term-VALID_TIME_FMT"><span class="xref std std-term">VALID_TIME_FMT</span></a>. For example, if VALID_TIME_FMT=%Y%m%d, then VALID_END must be set to a valid time matching YYYYMMDD, such as 20190202.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The time specified for this variable will not necessarily be processed. It is used to determine the cutoff of run times that can be processed. For example, if METplus Wrappers is configured to start at 20190201 and end at 20190202 processing data in 48 hour increments, it will process valid time 20190201 then increment the run time to 20190203. This is later than the VALID_END value, so execution will stop. However, if the increment is set to 24 hours (see <a class="reference internal" href="glossary.html#term-VALID_INCREMENT"><span class="xref std std-term">VALID_INCREMENT</span></a>), then METplus Wrappers will process valid times 20190201 and 20190202 before ending execution.</p>
</div>
<p><a class="reference internal" href="glossary.html#term-VALID_INCREMENT"><span class="xref std std-term">VALID_INCREMENT</span></a>:
This is the time interval to add to each run time to determine the next run time to process. See <a class="reference internal" href="#time-interval-units"><span class="std std-ref">Time Interval Units</span></a> for information on time interval formatting. Units of hours are assumed if no units are specified. This value must be greater than or equal to 60 seconds because the METplus wrappers currently do not support processing intervals of less than one minute.</p>
<p>The following is a configuration that will process valid time 2019-02-01 at 00Z until 2019-02-02 at 00Z in 6 hour (21600 seconds) increments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LOOP_BY</span> <span class="o">=</span> <span class="n">VALID</span>
<span class="n">VALID_TIME_FMT</span> <span class="o">=</span> <span class="o">%</span><span class="n">Y</span><span class="o">%</span><span class="n">m</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">H</span>
<span class="n">VALID_BEG</span> <span class="o">=</span> <span class="mi">2019020100</span>
<span class="n">VALID_END</span> <span class="o">=</span> <span class="mi">2019020200</span>
<span class="n">VALID_INCREMENT</span> <span class="o">=</span> <span class="mi">6</span><span class="n">H</span>
</pre></div>
</div>
<p>Note: Substituting VALID_INCREMENT = 21600 will generate the same result.</p>
<p>This will process data valid on 2019-02-01 at 00Z, 06Z, 12Z, and 18Z as well as 2019-02-02 at 00Z. For each of these valid times, the METplus wrappers can also loop over a set of forecast leads that are all valid at the current run time. See <a class="reference internal" href="#looping-over-forecast-leads"><span class="std std-ref">Looping over Forecast Leads</span></a> for more information.</p>
</div>
<div class="section" id="looping-by-initialization-time">
<span id="id2"></span><h4><span class="section-number">3.3.1.3. </span>Looping by Initialization Time<a class="headerlink" href="#looping-by-initialization-time" title="Permalink to this headline">¶</a></h4>
<p>When looping over initialization time (<a class="reference internal" href="glossary.html#term-LOOP_BY"><span class="xref std std-term">LOOP_BY</span></a> = INIT or LOOP_BY = RETRO), the following variables must be set:</p>
<p><a class="reference internal" href="glossary.html#term-INIT_TIME_FMT"><span class="xref std std-term">INIT_TIME_FMT</span></a>:
This is the format of the initialization times the user can configure in METplus Wrappers. The value of <a class="reference internal" href="glossary.html#term-INIT_BEG"><span class="xref std std-term">INIT_BEG</span></a> and <a class="reference internal" href="glossary.html#term-INIT_END"><span class="xref std std-term">INIT_END</span></a> must correspond to this format. Example: INIT_TIME_FMT = %Y%m%d%H. Using this format, the initialization time range values specified must be defined as YYYYMMDDHH, i.e. 2019020112.</p>
<p><a class="reference internal" href="glossary.html#term-INIT_BEG"><span class="xref std std-term">INIT_BEG</span></a>:
This is the first initialization time that will be processed. The format of this variable is controlled by <a class="reference internal" href="glossary.html#term-INIT_TIME_FMT"><span class="xref std std-term">INIT_TIME_FMT</span></a>. For example, if INIT_TIME_FMT = %Y%m%d, then INIT_BEG must be set to an initialization time matching YYYYMMDD, such as 20190201.</p>
<p><a class="reference internal" href="glossary.html#term-INIT_END"><span class="xref std std-term">INIT_END</span></a>:
This is the last initialization time that can be processed. The format of this variable is controlled by INIT_TIME_FMT. For example, if INIT_TIME_FMT = %Y%m%d, then INIT_END must be set to an initialization time matching YYYYMMDD, such as 20190202.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The time specified for this variable will not necessarily be processed. It is used to determine the cutoff of run times that can be processed. For example, if METplus Wrappers is configured to start at 2019-02-01 and end at 2019-02-02 processing data in 48 hour increments, it will process 2019-02-01 then increment the run time to 2019-02-03. This is later than the INIT_END valid, so execution will stop. However, if the increment is set to 24 hours (see INIT_INCREMENT), then METplus Wrappers will process initialization times 2019-02-01 and 2019-02-02 before ending executaion.</p>
</div>
<p><a class="reference internal" href="glossary.html#term-INIT_INCREMENT"><span class="xref std std-term">INIT_INCREMENT</span></a>:
This is the time interval to add to each run time to determine the next run time to process. See <a class="reference internal" href="#time-interval-units"><span class="std std-ref">Time Interval Units</span></a> for information on time interval formatting. Units of hours are assumed if no units are specified. This value must be greater than or equal to 60 seconds because the METplus wrappers currently do not support processing intervals of less than one minute.</p>
<p>The following is a configuration that will process initialization time 2019-02-01 at 00Z until 2019-02-02 at 00Z in 6 hour (21600 second) increments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LOOP_BY</span> <span class="o">=</span> <span class="n">INIT</span>
<span class="n">INIT_TIME_FMT</span> <span class="o">=</span> <span class="o">%</span><span class="n">Y</span><span class="o">%</span><span class="n">m</span><span class="o">%</span><span class="n">d</span><span class="o">%</span><span class="n">H</span>
<span class="n">INIT_BEG</span> <span class="o">=</span> <span class="mi">2019020100</span>
<span class="n">INIT_END</span> <span class="o">=</span> <span class="mi">2019020200</span>
<span class="n">INIT_INCREMENT</span> <span class="o">=</span> <span class="mi">6</span><span class="n">H</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Substituting VALID_INCREMENT = 21600 will generate the same result.</p>
</div>
<p>This will process data initialized on 2019-02-01 at 00Z, 06Z, 12Z, and 18Z as well as 2019-02-02 at 00Z. For each of these initialization times, METplus Wrappers can also loop over a set of forecast leads that are all initialized at the current run time. See <a class="reference internal" href="#looping-over-forecast-leads"><span class="std std-ref">Looping over Forecast Leads</span></a> for more information.</p>
</div>
<div class="section" id="looping-over-forecast-leads">
<span id="id3"></span><h4><span class="section-number">3.3.1.4. </span>Looping over Forecast Leads<a class="headerlink" href="#looping-over-forecast-leads" title="Permalink to this headline">¶</a></h4>
<p>Many of the wrappers will also loop over a list of forecast leads relative to the current valid/initialization time that is being processed.</p>
<div class="section" id="lead-seq">
<h5><a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a><a class="headerlink" href="#lead-seq" title="Permalink to this headline">¶</a></h5>
<p>This variable can be set to a comma-separated list of integer values (with optional units) to define the forecast leads that will be processed relative to the initialization/valid time. See <a class="reference internal" href="#time-interval-units"><span class="std std-ref">Time Interval Units</span></a> for information on time interval formatting. Units of hours are assumed if no units are specified. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LEAD_SEQ</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span>
</pre></div>
</div>
<p>If <a class="reference internal" href="glossary.html#term-LOOP_BY"><span class="xref std std-term">LOOP_BY</span></a> = VALID and the current run time is 2019-02-01 at 00Z, then three times will be processed:</p>
<div class="line-block">
<div class="line">1. Initialized on 2019-01-31 at 21Z / valid on 2019-02-01 at 00Z</div>
<div class="line">2. Initialized on 2019-01-31 at 18Z / valid on 2019-02-01 at 00Z</div>
<div class="line">3. Initialized on 2019-01-31 at 15Z / valid on 2019-02-01 at 00Z</div>
</div>
<p>If <a class="reference internal" href="glossary.html#term-LOOP_BY"><span class="xref std std-term">LOOP_BY</span></a> = INIT and the current run time is 2019-02-01 at 00Z, then three times will be processed:</p>
<div class="line-block">
<div class="line">1. Initialized on 2019-02-01 at 00Z / valid on 2019-02-01 at 03Z</div>
<div class="line">2. Initialized on 2019-02-01 at 00Z / valid on 2019-02-01 at 06Z</div>
<div class="line">3. Initialized on 2019-02-01 at 00Z / valid on 2019-02-01 at 09Z</div>
</div>
<p>You can also define <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a> using a special notation for many forecast leads. The notation is <strong>begin_end_incr(b,e,i)</strong> where b = the first lead value, e = the last lead value (inclusive), and i = the increment between leads. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LEAD_SEQ</span> <span class="o">=</span> <span class="n">begin_end_incr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LEAD_SEQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span>
</pre></div>
</div>
<p>Grouping forecast leads is possible as well using a special version of the <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a> variable for the
<strong>SeriesByLead Wrapper Only</strong>. If <a class="reference internal" href="glossary.html#term-SERIES_BY_LEAD_GROUP_FCSTS"><span class="xref std std-term">SERIES_BY_LEAD_GROUP_FCSTS</span></a> = True, then you can define groups of
forecast leads that will be evaluated together. You can define any number of these groups by setting
configuration variables LEAD_SEQ_1, LEAD_SEQ_2, …, <a class="reference internal" href="glossary.html#term-LEAD_SEQ_-n"><span class="xref std std-term">LEAD_SEQ_&lt;n&gt;</span></a>. You can define the value with a
comma-separated list of integers (currently only hours are supported here) or using the special begin_end_incr(b,e,i) notation described just
above. Each <a class="reference internal" href="glossary.html#term-LEAD_SEQ_-n"><span class="xref std std-term">LEAD_SEQ_&lt;n&gt;</span></a> must have a corresponding variable <a class="reference internal" href="glossary.html#term-LEAD_SEQ_-n-_LABEL"><span class="xref std std-term">LEAD_SEQ_&lt;n&gt;_LABEL</span></a>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SERIES_BY_LEAD_GROUP_FCSTS</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">LEAD_SEQ_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span>
<span class="n">LEAD_SEQ_1_LABEL</span> <span class="o">=</span> <span class="n">Day1</span>
<span class="n">LEAD_SEQ_2</span> <span class="o">=</span> <span class="n">begin_end_incr</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">LEAD_SEQ_2_LABEL</span> <span class="o">=</span> <span class="n">Day2</span>
</pre></div>
</div>
</div>
<div class="section" id="init-seq">
<h5><a class="reference internal" href="glossary.html#term-INIT_SEQ"><span class="xref std std-term">INIT_SEQ</span></a><a class="headerlink" href="#init-seq" title="Permalink to this headline">¶</a></h5>
<p>If METplus Wrappers is configured to loop by valid time (<a class="reference internal" href="glossary.html#term-LOOP_BY"><span class="xref std std-term">LOOP_BY</span></a> = VALID), you can use INIT_SEQ instead of <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a>. This is a list of initialization hours that are available in the data. This is useful if you know when the data is initialized and you need to use a different list of forecast leads depending on the valid time being evaluated. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LOOP_BY</span> <span class="o">=</span> <span class="n">VALID</span>
<span class="n">INIT_SEQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span>
</pre></div>
</div>
<p>At valid time 2019-02-01 00Z, this initialization sequence will build a forecast lead list of 0, 6, 12, 18, 24, 30, etc. and at valid time 2019-02-01 01Z, this initialization sequence will build a forecast lead list of 1, 7, 13, 19, 25, 31, etc.</p>
<p>If you utilize <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a>, you should restrict the forecast leads that will be used by setting <a class="reference internal" href="glossary.html#term-LEAD_SEQ_MIN"><span class="xref std std-term">LEAD_SEQ_MIN</span></a> and <a class="reference internal" href="glossary.html#term-LEAD_SEQ_MAX"><span class="xref std std-term">LEAD_SEQ_MAX</span></a>. For example, if you want to only process forecast leads between 12 and 24 you can set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LEAD_SEQ_MIN</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">LEAD_SEQ_MAX</span> <span class="o">=</span> <span class="mi">24</span>
</pre></div>
</div>
<p>At valid time 2019-02-01 00Z, this initialization sequence will build a forecast lead list of 12, 18, 24 and at valid time 2019-02-01 01Z, this initialization sequence will build a forecast lead list of 13, 19.</p>
<p>Setting minimum and maximum values will also affect the list of forecast leads if you use <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a>. <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a> takes precedence over <a class="reference internal" href="glossary.html#term-INIT_SEQ"><span class="xref std std-term">INIT_SEQ</span></a>, so if you have both variables set in your configuration, <a class="reference internal" href="glossary.html#term-INIT_SEQ"><span class="xref std std-term">INIT_SEQ</span></a> will be ignored in favor of <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a>.</p>
</div>
</div>
<div class="section" id="time-interval-units">
<span id="id4"></span><h4><span class="section-number">3.3.1.5. </span>Time Interval Units<a class="headerlink" href="#time-interval-units" title="Permalink to this headline">¶</a></h4>
<p>Time intervals defined in configuration variables each have default values: <a class="reference internal" href="glossary.html#term-LEAD_SEQ"><span class="xref std std-term">LEAD_SEQ</span></a> and <a class="reference internal" href="glossary.html#term-INIT_SEQ"><span class="xref std std-term">INIT_SEQ</span></a> default to hours, <a class="reference internal" href="glossary.html#term-VALID_INCREMENT"><span class="xref std std-term">VALID_INCREMENT</span></a> and <a class="reference internal" href="glossary.html#term-INIT_INCREMENT"><span class="xref std std-term">INIT_INCREMENT</span></a> default to seconds.
Units of years, months, days, hours, minutes, or seconds can also be specified by adding a letter (Y, m, d, H, M, or S respectively) to the end of the number.
If no units are specified, seconds are assumed.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3600</span> <span class="p">:</span> <span class="mi">3600</span> <span class="n">seconds</span>
<span class="mi">3600</span><span class="n">S</span> <span class="p">:</span> <span class="mi">3600</span> <span class="n">seconds</span>
<span class="mi">60</span><span class="n">M</span> <span class="p">:</span> <span class="mi">60</span> <span class="n">minutes</span> <span class="ow">or</span> <span class="mi">3600</span> <span class="n">seconds</span>
<span class="mi">1</span><span class="n">H</span> <span class="p">:</span> <span class="mi">1</span> <span class="n">hour</span> <span class="ow">or</span> <span class="mi">3600</span> <span class="n">seconds</span>
<span class="mi">1</span><span class="n">m</span> <span class="p">:</span> <span class="mi">1</span> <span class="n">month</span> <span class="p">(</span><span class="n">relative</span><span class="p">)</span>
<span class="mi">1</span><span class="n">d</span> <span class="p">:</span> <span class="mi">1</span> <span class="n">day</span> <span class="ow">or</span> <span class="mi">24</span> <span class="n">hours</span> <span class="ow">or</span> <span class="mi">86400</span> <span class="n">seconds</span>
<span class="mi">1</span><span class="n">Y</span> <span class="p">:</span> <span class="mi">1</span> <span class="n">year</span> <span class="p">(</span><span class="n">relative</span><span class="p">)</span>
</pre></div>
</div>
<p>Units of months (m) and years (Y) do not have set intervals because the length of a month or year is relative to the relative date/time.
Therefore these intervals are calculated based on the current run time and cannot be expressed in seconds unless the run time value is available.</p>
</div>
<div class="section" id="skipping-times">
<h4><span class="section-number">3.3.1.6. </span>Skipping Times<a class="headerlink" href="#skipping-times" title="Permalink to this headline">¶</a></h4>
<p>New in 3.1 is the ability to skip certain valid times. The configuration variable <a class="reference internal" href="glossary.html#term-SKIP_TIMES"><span class="xref std std-term">SKIP_TIMES</span></a> can be used to
provide a list of time formats each with a list of times to not process. The format and time list are separated by
a colon. Any numeric python strftime formatting directive can be used as the time format (see
<a class="reference external" href="https://strftime.org">https://strftime.org</a>). Each item in the list must be surrounded by quotation marks. Here are a few examples.</p>
<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;%m:3&quot;</span>
</pre></div>
</div>
<p>This will skip the 3rd month, March.</p>
<p>Example 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">:30,31&quot;</span>
</pre></div>
</div>
<p>This will skip every 30th and 31st day.</p>
<p>Example 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">:30,31&quot;</span><span class="p">,</span> <span class="s2">&quot;%m:3&quot;</span>
</pre></div>
</div>
<p>This will skip every 30th and 31st day <strong>and</strong> every 3rd month.</p>
<p>You can use <strong>begin_end_incr(b,e,i)</strong> syntax to define a range of times to skip. b = begin value, e = end value,
i = increment between each value</p>
<p>Example 4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;%H:begin_end_incr(0,22,2)&quot;</span>
</pre></div>
</div>
<p>This will skip every even hour (starting from 0, ending on 22, by 2). This is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;%H:0,2,4,6,8,10,12,14,16,18,20,22&quot;</span>
</pre></div>
</div>
<p>You can also specify multiple strftime directives in a single time format.</p>
<p>Example 5:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">:19991231, 20141031&quot;</span>
</pre></div>
</div>
<p>This will skip the dates Dec. 31, 1999 and Oct. 31, 2014.</p>
<p>If you only want to skip certain times for a single wrapper, you can use a wrapper-specific variable.
Using a wrapper-specific variable will ignore the generic SKIP_TIMES values.</p>
<p>Example 6:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">GRID_STAT_SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;%m:3,4,5,6,7,8,9,10,11&quot;</span>
<span class="n">SKIP_TIMES</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">:31&quot;</span>
</pre></div>
</div>
<p>This will skip the months March through November for GridStat wrapper only. All other wrappers in the
<a class="reference internal" href="glossary.html#term-PROCESS_LIST"><span class="xref std std-term">PROCESS_LIST</span></a> will skip the 31st day of each month. Note that the SKIP_TIMES values are not applied
to GridStat in this case.</p>
</div>
<div class="section" id="realtime-looping">
<h4><span class="section-number">3.3.1.7. </span>Realtime Looping<a class="headerlink" href="#realtime-looping" title="Permalink to this headline">¶</a></h4>
<div class="section" id="now-and-today">
<h5>Now and Today<a class="headerlink" href="#now-and-today" title="Permalink to this headline">¶</a></h5>
<p>To make running in realtime easier, the METplus Wrappers support defining the begin and end times relative to
the current clock time. For example, if the current time is 2019-04-26 08:17 and you start the METplus Wrappers
with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
VALID_END = {now?fmt=%Y%m%d%H}
</pre></div>
</div>
<p>then the value of <a class="reference internal" href="glossary.html#term-VALID_END"><span class="xref std std-term">VALID_END</span></a> will be set to 2019042608. You can also use {today} to substitute the
current YYYYMMDD, i.e. 20190426. You cannot change the formatting for the ‘today’ keyword.</p>
</div>
<div class="section" id="shift-keyword">
<h5>Shift Keyword<a class="headerlink" href="#shift-keyword" title="Permalink to this headline">¶</a></h5>
<p>You can use the ‘shift’ keyword to shift the current time by any number of seconds. For example, if you start
the METplus Wrappers at the same clock time with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
VALID_BEG = {now?fmt=%Y%m%d%H?shift=-86400}
</pre></div>
</div>
<p>then the value of <a class="reference internal" href="glossary.html#term-VALID_BEG"><span class="xref std std-term">VALID_BEG</span></a> will be set to the current clock time shifted by -86400 seconds (24 hours backwards), or 2019-04-25 08Z.</p>
<p>The value defined for ‘shift’  also supported <a class="reference internal" href="#time-interval-units"><span class="std std-ref">Time Interval Units</span></a></p>
<p>If <a class="reference internal" href="glossary.html#term-VALID_INCREMENT"><span class="xref std std-term">VALID_INCREMENT</span></a> is set to 21600 seconds (6 hours), then the METplus Wrappers will process the following valid times:</p>
<div class="line-block">
<div class="line">2019-04-25 08Z</div>
<div class="line">2019-04-25 14Z</div>
<div class="line">2019-04-25 20Z</div>
<div class="line">2019-04-26 02Z</div>
<div class="line">2019-04-26 08Z</div>
</div>
</div>
<div class="section" id="truncate-keyword">
<h5>Truncate Keyword<a class="headerlink" href="#truncate-keyword" title="Permalink to this headline">¶</a></h5>
<p>You may want to configure the METplus Wrappers to process at 00Z, 06Z, 12Z, and 18Z of a given day instead of 02Z, 08Z, 14Z, and 20Z. Having to adjust the shift amount differently if you are running at 08Z or 09Z to get the times to line up would be tedious. Instead, use the ‘truncate’ keyword. The value set here is the number of seconds that is used to determine the interval of time to round down. If you want to process every 6 hours, set ‘truncate’ to 21600 seconds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
VALID_BEG = {now?fmt=%Y%m%d%H?shift=-86400?truncate=21600}
</pre></div>
</div>
<p>This will round down the value to the nearest 6 hour interval of time. Starting METplus Wrappers on or after 06Z but before 12Z on 20190426 will result in VALID_BEG = 2019042506 (clock time shifted backwards by 24 hours then truncated to the nearest 6 hour time).</p>
<p>Starting METplus Wrappers on 20190426 at 08:16 with the following configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
LOOP_BY = VALID
VALID_TIME_FMT = %Y%m%d%H
VALID_BEG = {now?fmt=%Y%m%d%H?shift=-86400?truncate=21600}
VALID_END = {now?fmt=%Y%m%d%H}
VALID_INCREMENT = 21600
</pre></div>
</div>
<p>will process valid times starting on 20190425 at 06Z every 6 hours until the current run time is later than 20190426 at 08Z, which will result in processing the following valid times:</p>
<div class="line-block">
<div class="line">20190425_06</div>
<div class="line">20190425_12</div>
<div class="line">20190425_18</div>
<div class="line">20190426_00</div>
<div class="line">20190426_06</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using the ‘now’ keyword, the value of VALID_TIME_FMT must be identical to the ‘fmt’ value corresponding to the ‘now’ item in VALID_BEG and VALID_END. In the above example, this would be the %Y%m%d%H portion within values of the VALID_TIME_FMT, VALID_BEG, and VALID_END variables.</p>
</div>
</div>
</div>
</div>
<div class="section" id="loop-order">
<span id="id5"></span><h3><span class="section-number">3.3.2. </span>Loop Order<a class="headerlink" href="#loop-order" title="Permalink to this headline">¶</a></h3>
<p>The METplus wrappers can be configured to loop first by times then processes or vice-versa. Looping by times first will run each process in the process list for a given run time, increment to the next run time, run each process in the process list, and so on. Looping by processes first will run all times for the first process, then run all times for the second process, and so on.</p>
<p>Example 1 Configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LOOP_ORDER</span> <span class="o">=</span> <span class="n">times</span>

<span class="n">PROCESS_LIST</span> <span class="o">=</span> <span class="n">PCPCombine</span><span class="p">,</span> <span class="n">GridStat</span>

<span class="n">VALID_BEG</span> <span class="o">=</span> <span class="mi">20190201</span>
<span class="n">VALID_END</span> <span class="o">=</span> <span class="mi">20190203</span>
<span class="n">VALID_INCREMENT</span> <span class="o">=</span> <span class="mi">1</span><span class="n">d</span>
</pre></div>
</div>
<p>will run in the following order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">PCPCombine</span> <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>
<span class="o">*</span> <span class="n">GridStat</span>   <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>
<span class="o">*</span> <span class="n">PCPCombine</span> <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">02</span>
<span class="o">*</span> <span class="n">GridStat</span>   <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">02</span>
<span class="o">*</span> <span class="n">PCPCombine</span> <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">03</span>
<span class="o">*</span> <span class="n">GridStat</span>   <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">03</span>
</pre></div>
</div>
<p>Example 2 Configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">LOOP_ORDER</span> <span class="o">=</span> <span class="n">processes</span>

<span class="n">PROCESS_LIST</span> <span class="o">=</span> <span class="n">PCPCombine</span><span class="p">,</span> <span class="n">GridStat</span>

<span class="n">VALID_BEG</span> <span class="o">=</span> <span class="mi">20190201</span>
<span class="n">VALID_END</span> <span class="o">=</span> <span class="mi">20190203</span>
<span class="n">VALID_INCREMENT</span> <span class="o">=</span> <span class="mi">1</span><span class="n">d</span>
</pre></div>
</div>
<p>will run in the following order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">PCPCombine</span> <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>
<span class="o">*</span> <span class="n">PCPCombine</span> <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">02</span>
<span class="o">*</span> <span class="n">PCPCombine</span> <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">03</span>
<span class="o">*</span> <span class="n">GridStat</span>   <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span>
<span class="o">*</span> <span class="n">GridStat</span>   <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">02</span>
<span class="o">*</span> <span class="n">GridStat</span>   <span class="n">at</span> <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">03</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If running a MET tool that processes data over a time range such as SeriesAnalysis or StatAnalysis must be run with LOOP_ORDER = processes.</p>
</div>
</div>
<div class="section" id="custom-looping">
<span id="id6"></span><h3><span class="section-number">3.3.3. </span>Custom Looping<a class="headerlink" href="#custom-looping" title="Permalink to this headline">¶</a></h3>
<p>A list of text strings can be defined in the METplus wrappers configuration files to allow each wrapper to process data multiple times for each run time. The strings can be referenced in various places in the METplus configuration files to change input/output file paths, configuration file paths, and more. The value of each list item can be referenced in the METplus configuration variables by using {custom?fmt=%s}. The variable CUSTOM_LOOP_LIST will apply the values to each wrapper in the PROCESS_LIST unless the wrapper does not support this functionality. CyclonePlotter, MakePlots, SeriesByInit, SeriesByLead, StatAnalysis, TCStat, and TCMPRPlotter wrappers are not supported. If the variable is not set or set to an empty string, the wrapper will execute as normal without additional runs. The name of the wrapper-specific variables contain the name of the wrapper, i.e. SERIES_ANALYSIS_CUSTOM_LOOP_LIST, PCP_COMBINE_CUSTOM_LOOP_LIST, GRID_STAT_CUSTOM_LOOP_LIST, etc. Setting these variables will override the value set for CUSTOM_LOOP_LIST for that wrapper only.</p>
<p><strong>Example 1 Configuration</strong> (Reading different input files):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
PROCESS_LIST = PCPCombine

VALID_BEG = 20190201
VALID_END = 20190203
VALID_INCREMENT = 1d

PCP_COMBINE_CUSTOM_LOOP_LIST = mem_001, mem_002

[dir]
FCST_PCP_COMBINE_INPUT_DIR = /d1/ensemble

[filename_templates]
FCST_PCP_COMBINE_INPUT_TEMPLATE = {custom?fmt=%s}/{valid?fmt=%Y%m%d}.nc
</pre></div>
</div>
<p>This configuration will run the following:</p>
<ul class="simple">
<li><p>PCPCombine at 2019-02-01 reading from /d1/ensemble/mem_001/20190201.nc</p></li>
<li><p>PCPCombine at 2019-02-01 reading from /d1/ensemble/mem_002/20190201.nc</p></li>
<li><p>PCPCombine at 2019-02-02 reading from /d1/ensemble/mem_001/20190202.nc</p></li>
<li><p>PCPCombine at 2019-02-02 reading from /d1/ensemble/mem_002/20190202.nc</p></li>
<li><p>PCPCombine at 2019-02-03 reading from /d1/ensemble/mem_001/20190203.nc</p></li>
<li><p>PCPCombine at 2019-02-03 reading from /d1/ensemble/mem_002/20190203.nc</p></li>
</ul>
<p><strong>Example 2 Configuration</strong> (Using different MET config files):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
PROCESS_LIST = SeriesAnalysis

VALID_BEG = 20190201
VALID_END = 20190203
VALID_INCREMENT = 1d

SERIES_ANALYSIS_CUSTOM_LOOP_LIST = one, two

SERIES_ANALYSIS_CONFIG_FILE = {CONFIG_DIR}/SAConfig_{custom?fmt=%s}

[dir]
SERIES_ANALYSIS_OUTPUT_DIR = {OUTPUT_BASE}/SA/{custom?fmt=%s}
</pre></div>
</div>
<p>This configuration will run SeriesAnalysis:</p>
<ul class="simple">
<li><p>At 2019-02-01 using SAConfig_one config file and writing output to {OUTPUT_BASE}/SA/one</p></li>
<li><p>At 2019-02-01 using SAConfig_two config file and writing output to {OUTPUT_BASE}/SA/two</p></li>
<li><p>At 2019-02-02 using SAConfig_one config file and writing output to {OUTPUT_BASE}/SA/one</p></li>
<li><p>At 2019-02-02 using SAConfig_two config file and writing output to {OUTPUT_BASE}/SA/two</p></li>
<li><p>At 2019-02-03 using SAConfig_one config file and writing output to {OUTPUT_BASE}/SA/one</p></li>
<li><p>At 2019-02-03 using SAConfig_two config file and writing output to {OUTPUT_BASE}/SA/two</p></li>
</ul>
</div>
<div class="section" id="field-info">
<span id="id7"></span><h3><span class="section-number">3.3.4. </span>Field Info<a class="headerlink" href="#field-info" title="Permalink to this headline">¶</a></h3>
<p>This section describes how METplus Wrappers configuration variables can be used to define field information that is sent to the MET applications to read forecast and observation fields.</p>
<div class="section" id="fcst-var-n-name">
<h4><span class="section-number">3.3.4.1. </span><a class="reference internal" href="glossary.html#term-FCST_VAR-n-_NAME"><span class="xref std std-term">FCST_VAR&lt;n&gt;_NAME</span></a><a class="headerlink" href="#fcst-var-n-name" title="Permalink to this headline">¶</a></h4>
<p>Set this to the name of a forecast variable that you want to evaluate. &lt;n&gt; is any integer greater than or equal to 1, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR2_NAME</span> <span class="o">=</span> <span class="n">RH</span>
</pre></div>
</div>
<p>If this value is set for a given &lt;n&gt; value, then the corresponding OBS_VAR&lt;n&gt;_NAME must be set. If the value for forecast and observation data are the same, BOTH_VAR&lt;n&gt;_NAME can be used instead.</p>
</div>
<div class="section" id="fcst-var-n-levels">
<h4><span class="section-number">3.3.4.2. </span><a class="reference internal" href="glossary.html#term-FCST_VAR-n-_LEVELS"><span class="xref std std-term">FCST_VAR&lt;n&gt;_LEVELS</span></a><a class="headerlink" href="#fcst-var-n-levels" title="Permalink to this headline">¶</a></h4>
<p>Set this to a comma-separated list of levels or a single value. FCST_VAR1_LEVELS corresponds to FCST_VAR1_NAME, FCST_VAR2_LEVELS corresponds to FCST_VAR2_NAME, etc. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span><span class="p">,</span> <span class="n">P750</span>
</pre></div>
</div>
<p>will process TMP at P500 and TMP at P750. If FCST_VAR&lt;n&gt;_LEVELS and FCST_VAR&lt;n&gt;_NAME are set, then the corresponding OBS_VAR&lt;n&gt;_LEVELS and OBS_VAR&lt;n&gt;_NAME must be set. If the value for forecast and observation data are the same, BOTH_VAR&lt;n&gt;_NAME and BOTH_VAR&lt;n&gt;_LEVELS can be used instead.</p>
</div>
<div class="section" id="obs-var-n-name">
<h4><span class="section-number">3.3.4.3. </span><a class="reference internal" href="glossary.html#term-OBS_VAR-n-_NAME"><span class="xref std std-term">OBS_VAR&lt;n&gt;_NAME</span></a><a class="headerlink" href="#obs-var-n-name" title="Permalink to this headline">¶</a></h4>
<p>Set this to the corresponding observation variable that you want to evaluate with FCST_VAR&lt;n&gt;_NAME. If this value is set for a given &lt;n&gt; value, then the corresponding FCST_VAR&lt;n&gt;_NAME must be set. If the value for forecast and observation data are the same, BOTH_VAR&lt;n&gt;_NAME can be used instead.</p>
</div>
<div class="section" id="obs-var-n-levels">
<h4><span class="section-number">3.3.4.4. </span><a class="reference internal" href="glossary.html#term-OBS_VAR-n-_LEVELS"><span class="xref std std-term">OBS_VAR&lt;n&gt;_LEVELS</span></a><a class="headerlink" href="#obs-var-n-levels" title="Permalink to this headline">¶</a></h4>
<p>Set this to a comma-separated list of levels or a single value. If OBS_VAR&lt;n&gt;_LEVELS and OBS_VAR&lt;n&gt;_NAME are set, then the corresponding FCST_VAR&lt;n&gt;_LEVELS and FCST_VAR&lt;n&gt;_NAME must be set. If the value for forecast and observation data are the same, BOTH_VAR&lt;n&gt;_NAME and BOTH_VAR&lt;n&gt;_LEVELS can be used instead. For example, setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">BOTH_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">BOTH_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>
<span class="n">BOTH_VAR2_NAME</span> <span class="o">=</span> <span class="n">RH</span>
<span class="n">BOTH_VAR2_LEVELS</span> <span class="o">=</span> <span class="n">P750</span><span class="p">,</span> <span class="n">P250</span>
</pre></div>
</div>
<p>is the equivalent of setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>
<span class="n">FCST_VAR2_NAME</span> <span class="o">=</span> <span class="n">RH</span>
<span class="n">FCST_VAR2_LEVELS</span> <span class="o">=</span> <span class="n">P750</span><span class="p">,</span> <span class="n">P250</span>
<span class="n">OBS_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">OBS_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>
<span class="n">OBS_VAR2_NAME</span> <span class="o">=</span> <span class="n">RH</span>
<span class="n">OBS_VAR2_LEVELS</span> <span class="o">=</span> <span class="n">P750</span><span class="p">,</span> <span class="n">P250</span>
</pre></div>
</div>
<p>This will compare:</p>
<div class="line-block">
<div class="line">TMP/P500 in the forecast data to TMP/P500 in the observation data</div>
<div class="line">RH/P750 in the forecast data to RH/P750 in the observation data</div>
<div class="line">RH/P250 in the forecast data to RH/P250 in the observation data</div>
</div>
<p>If you set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span><span class="p">,</span> <span class="n">P750</span>
<span class="n">OBS_VAR1_NAME</span> <span class="o">=</span> <span class="n">TEMP</span>
<span class="n">OBS_VAR1_LEVELS</span> <span class="o">=</span> <span class="s2">&quot;(0,*,*)&quot;</span><span class="p">,</span><span class="s2">&quot;(1,*,*)&quot;</span>
</pre></div>
</div>
<p>METplus Wrappers will compare:</p>
<div class="line-block">
<div class="line">TMP/P500 in the forecast data to TEMP at (0,*,*) in the observation data</div>
<div class="line">TMP/P750 in the forecast data to TEMP at (1,*,*) in the observation data</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NetCDF level values that contain (*,*) notation must be surrounded by quotation marks so it will not be misinterpreted as a list of items.</p>
</div>
<p>The number of level items must be equal in each list for a given comparison. If you define separate names for a forecast and observation, you will need to define separate levels for both even if they are equivalent. For example, setting FCST_VAR1_NAME, FCST_VAR1_LEVELS, and OBS_VAR1_NAME, but not setting OBS_VAR1_LEVELS will result in an error.</p>
<p>The field information specified using the *_NAME/*_LEVELS variables will be formatted to match the field info dictionary in the MET config files and passed to the appropriate config file to evaluate the data. The previous configuration comparing TMP (P500 and P750) in the forecast data and TEMP ((0,*,*)) in the observation data will generate the following in the MET config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fcst</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TMP&quot;</span><span class="p">;</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;P500&quot;</span><span class="p">;}</span> <span class="p">];}</span>
<span class="n">obs</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">=</span> <span class="p">[{</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TEMP&quot;</span><span class="p">;</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;(0,*,*)&quot;</span><span class="p">;}</span> <span class="p">];}</span>
</pre></div>
</div>
<p>and then comparing TMP (P500 and P750) in the forecast data and TEMP ((1,*,*)) in the observation data will generate the following in the MET config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fcst</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TMP&quot;</span><span class="p">;</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;P750&quot;</span><span class="p">;}</span> <span class="p">];}</span>
<span class="n">obs</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">=</span> <span class="p">[{</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TEMP&quot;</span><span class="p">;</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;(1,*,*)&quot;</span><span class="p">;}</span> <span class="p">];}</span>
</pre></div>
</div>
<p>Note that some MET applications allow multiple fields to be specified for a single run. If the MET tool allows it and METplus Wrappers is configured accordingly, these two comparisons would be configured in a single run.</p>
</div>
<div class="section" id="fcst-var-n-thresh-obs-var-n-thresh">
<h4><span class="section-number">3.3.4.5. </span><a class="reference internal" href="glossary.html#term-FCST_VAR-n-_THRESH"><span class="xref std std-term">FCST_VAR&lt;n&gt;_THRESH</span></a> / <a class="reference internal" href="glossary.html#term-OBS_VAR-n-_THRESH"><span class="xref std std-term">OBS_VAR&lt;n&gt;_THRESH</span></a><a class="headerlink" href="#fcst-var-n-thresh-obs-var-n-thresh" title="Permalink to this headline">¶</a></h4>
<p>Set this to a comma-separated list of threshold values to use in the comparison. Each of these values must begin with a comparison operator (&gt;, &gt;=, =, ==, !=, &lt;, &lt;=, gt, ge, eq, ne, lt, or le). For example, setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>
<span class="n">FCST_VAR1_THRESH</span> <span class="o">=</span> <span class="n">le0</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">gt0</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="n">gt0</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">gt0</span><span class="o">.</span><span class="mi">8</span>
</pre></div>
</div>
<p>will add the following information to the MET config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fcst</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TMP&quot;</span><span class="p">;</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;P500&quot;</span><span class="p">;</span> <span class="n">cat_thresh</span><span class="o">=</span><span class="p">[</span> <span class="n">le0</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">gt0</span><span class="o">.</span><span class="mi">4</span><span class="p">,</span> <span class="n">gt0</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="n">gt0</span><span class="o">.</span><span class="mi">8</span><span class="p">];}</span> <span class="p">];}</span>
</pre></div>
</div>
<p>If FCST_VAR&lt;n&gt;_THRESH is set, then OBS_VAR&lt;n&gt;_THRESH must be set. If the threshold list is the same for both forecast and observation data, BOTH_VAR&lt;n&gt;_THRESH can be used instead.</p>
</div>
<div class="section" id="fcst-var-n-options-obs-var-n-options">
<h4><span class="section-number">3.3.4.6. </span><a class="reference internal" href="glossary.html#term-FCST_VAR-n-_OPTIONS"><span class="xref std std-term">FCST_VAR&lt;n&gt;_OPTIONS</span></a> /  <a class="reference internal" href="glossary.html#term-OBS_VAR-n-_OPTIONS"><span class="xref std std-term">OBS_VAR&lt;n&gt;_OPTIONS</span></a><a class="headerlink" href="#fcst-var-n-options-obs-var-n-options" title="Permalink to this headline">¶</a></h4>
<p>Set this to add additional information to the field dictionary in the MET config file. The item must end with a semi-colon. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>
<span class="n">FCST_VAR1_OPTIONS</span> <span class="o">=</span> <span class="n">GRIB_lvl_typ</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span> <span class="n">ens_phist_bin_size</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span>
</pre></div>
</div>
<p>will add the following to the MET config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fcst</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TMP&quot;</span><span class="p">;</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;P500&quot;</span><span class="p">;</span> <span class="n">GRIB_lvl_typ</span> <span class="o">=</span> <span class="mi">105</span><span class="p">;</span> <span class="n">ens_phist_bin_size</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;}</span> <span class="p">];}</span>
</pre></div>
</div>
<p>If FCST_VAR&lt;n&gt;_OPTIONS is set, OBS_VAR&lt;n&gt;_OPTIONS does not need to be set, and vice-versa. If the extra options are the same for both forecast and observation data, BOTH_VAR&lt;n&gt;_OPTIONS can be used instead.</p>
<p><a class="reference internal" href="glossary.html#term-ENS_VAR-n-_NAME"><span class="xref std std-term">ENS_VAR&lt;n&gt;_NAME</span></a> / <a class="reference internal" href="glossary.html#term-ENS_VAR-n-_LEVELS"><span class="xref std std-term">ENS_VAR&lt;n&gt;_LEVELS</span></a>/ <a class="reference internal" href="glossary.html#term-ENS_VAR-n-_THRESH"><span class="xref std std-term">ENS_VAR&lt;n&gt;_THRESH</span></a> / <a class="reference internal" href="glossary.html#term-ENS_VAR-n-_OPTIONS"><span class="xref std std-term">ENS_VAR&lt;n&gt;_OPTIONS</span></a>:
<strong>Used with EnsembleStat Wrapper only.</strong> Users may want to define the ens dictionary item in the MET EnsembleStat config file differently than the fcst dictionary item. If this is the case, you can use these variables. If it is not set, the values in the corresponding FCST_VAR&lt;n&gt;_[NAME/LEVELS/THRESH/OPTIONS] will be used in the ens dictionary.</p>
</div>
<div class="section" id="wrapper-specific-field-info">
<h4><span class="section-number">3.3.4.7. </span>Wrapper Specific Field Info<a class="headerlink" href="#wrapper-specific-field-info" title="Permalink to this headline">¶</a></h4>
<p>New to METplus 3.0 is the ability to specify VAR&lt;n&gt; items differently across comparison wrappers. In previous versions, it was assumed that the list of forecast and observation files that were processed would be applied to any MET Stat tool used, such as GridStat, PointStat, EnsembleStat, MODE, or MTD. This prevented the ability to run, for example, EnsembleStat, then pass the output into GridStat.</p>
<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">PROCESS_LIST</span> <span class="o">=</span> <span class="n">EnsembleStat</span><span class="p">,</span> <span class="n">GridStat</span>

<span class="n">FCST_ENSEMBLE_STAT_VAR1_NAME</span> <span class="o">=</span> <span class="n">HGT</span>
<span class="n">FCST_ENSEMBLE_STAT_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>

<span class="n">FCST_GRID_STAT_VAR1_NAME</span> <span class="o">=</span> <span class="n">HGT_P500_ENS_MEAN</span>
<span class="n">FCST_GRID_STAT_VAR1_LEVELS</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>
</pre></div>
</div>
<p>If the generic <a class="reference internal" href="glossary.html#term-FCST_VAR-n-_NAME"><span class="xref std std-term">FCST_VAR&lt;n&gt;_NAME</span></a> variables are used, the same values will be applied to all tools that don’t have wrapper specific fields defined. If wrapper specific fields are defined, any generic fields will be ignored.</p>
<p>Example 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">PROCESS_LIST</span> <span class="o">=</span> <span class="n">GridStat</span><span class="p">,</span> <span class="n">EnsembleStat</span>

<span class="n">FCST_VAR1_NAME</span> <span class="o">=</span> <span class="n">HGT</span>
<span class="n">FCST_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span><span class="p">,</span> <span class="n">P750</span>
<span class="n">FCST_VAR2_NAME</span> <span class="o">=</span> <span class="n">TMP</span>
<span class="n">FCST_VAR2_LEVELS</span> <span class="o">=</span> <span class="n">P500</span><span class="p">,</span> <span class="n">P750</span>

<span class="n">FCST_ENSEMBLE_STAT_VAR1_NAME</span> <span class="o">=</span> <span class="n">HGT</span>
<span class="n">FCST_ENSEMBLE_STAT_VAR1_LEVELS</span> <span class="o">=</span> <span class="n">P500</span>
</pre></div>
</div>
<p>In this example, GridStat will process HGT at pressure levels 500 and 750 and TMP at pressure levels 500 and 750, while EnsembleStat will only process HGT at pressure level 500. To configure EnsembleStat to also process TMP, the user will have to define it explicitly with FCST_ENSEMBLE_STAT_VAR2_NAME.</p>
<p>This functionality applies to GridStat, EnsembleStat, PointStat, MODE, and MTD wrappers only.</p>
<p>For more information on GRIB_lvl_typ and other file-specific commands, review the MET User’s Guide, Chapter 3.</p>
</div>
</div>
<div class="section" id="directory-and-filename-template-info">
<span id="id8"></span><h3><span class="section-number">3.3.5. </span>Directory and Filename Template Info<a class="headerlink" href="#directory-and-filename-template-info" title="Permalink to this headline">¶</a></h3>
<p>The METplus Wrappers use directory and filename template configuration variables to find the desired files for a given run.</p>
<div class="section" id="using-templates-to-find-observation-data">
<h4><span class="section-number">3.3.5.1. </span>Using Templates to find Observation Data<a class="headerlink" href="#using-templates-to-find-observation-data" title="Permalink to this headline">¶</a></h4>
<p>The following configuration variables describe input observation data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[dir]
OBS_GRID_STAT_INPUT_DIR = /my/path/to/grid_stat/input/obs

[filename_templates]
OBS_GRID_STAT_INPUT_TEMPLATE = {valid?fmt=%Y%m%d}/prefix.{valid?fmt=%Y%m%d%H}.ext
</pre></div>
</div>
<div class="line-block">
<div class="line">The input directory is the top level directory containing all of the observation data. The template contains items with keywords that will be substituted with time values for each run. After the values are substituted, METplus Wrappers will check to see if the desired file exists relative to the input directory. At valid time 20190201_12Z, the full desired path of the observation input data to grid_stat will be:</div>
<div class="line-block">
<div class="line">/my/path/to/grid_stat/input/obs/20190201/prefix.2019020112.ext</div>
</div>
</div>
<p>Note that the template contains a dated subdirectory. This cannot go in the OBS_GRID_STAT_INPUT_DIR variable because the dated subdirectory changes based on the run time.</p>
<div class="line-block">
<div class="line">METplus Wrappers does not need to be configured to loop by valid time to find files using a template containing valid time information. For example, at initialization time 20190201_12Z and forecast lead 3, the valid time is calculated to be 20190201_15Z and the full desired path of the observation input data to grid_stat will be:</div>
<div class="line-block">
<div class="line">/my/path/to/grid_stat/input/obs/20190201/prefix.2019020115.ext</div>
</div>
</div>
<p>The ‘init’ and ‘valid’ are keywords used to denote initialization and valid times respectively. Other keywords that are supported include ‘lead’, ‘offset’, ‘da_init’, and ‘cycle’ which can all be used to find forecast data and data assimilation data depending on the task.</p>
</div>
<div class="section" id="using-templates-to-find-forecast-data">
<h4><span class="section-number">3.3.5.2. </span>Using Templates to find Forecast Data<a class="headerlink" href="#using-templates-to-find-forecast-data" title="Permalink to this headline">¶</a></h4>
<p>Most forecast files contain the initialization time and the forecast lead in the filename. The keywords ‘init’ and ‘lead’ can be used to describe the template of these files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[dir]
FCST_GRID_STAT_INPUT_DIR = /my/path/to/grid_stat/input/fcst

[filename_templates]
FCST_GRID_STAT_INPUT_TEMPLATE = prefix.{init?fmt=%Y%m%d%H}_f{lead?fmt=%3H}.ext
</pre></div>
</div>
<div class="line-block">
<div class="line">For a valid time of 20190201_00Z and a forecast lead of 3, METplus Wrappers will look for the following forecast file:</div>
<div class="line-block">
<div class="line">/my/path/to/grid_stat/input/fcst/prefix.2019013121_f003.ext</div>
</div>
</div>
</div>
<div class="section" id="using-templates-to-find-data-assimilation-data">
<h4><span class="section-number">3.3.5.3. </span>Using Templates to find Data Assimilation Data<a class="headerlink" href="#using-templates-to-find-data-assimilation-data" title="Permalink to this headline">¶</a></h4>
<p>Some data assimilation files contain offset and da_init (data assimilation initialization) values in the filename. These values are used to determine the valid time of the data. Consider the following configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
PB2NC_OFFSETS = 6, 3

[dir]
PB2NC_INPUT_DIR = /my/path/to/prepbufr

[filename_templates]
PB2NC_INPUT_TEMPLATE = prefix.{da_init?fmt=%Y%m%d}_{cycle?fmt=%H}_off{offset?fmt=%2H}.ext
</pre></div>
</div>
<div class="line-block">
<div class="line">The PB2NC_OFFSETS list tells METplus Wrappers the order in which to prioritize files with offsets in the name. At valid time 20190201_12Z, METplus Wrappers will check if the following file exists:</div>
<div class="line-block">
<div class="line">/my/path/to/prepbufr/prefix.20190201_18_off06.ext</div>
</div>
</div>
<div class="line-block">
<div class="line">The offset is added to the valid time to get the data assimilation initialization time. Note that ‘cycle’ can be used interchangeably with ‘da_init’. It is generally used to specify the hour of the data that was generated. If that file doesn’t exist, it will check if the following file exists:</div>
<div class="line-block">
<div class="line">/my/path/to/prepbufr/prefix.20190201_15_off03.ext</div>
</div>
</div>
</div>
<div class="section" id="shifting-times-in-filename-templates">
<h4><span class="section-number">3.3.5.4. </span>Shifting Times in Filename Templates<a class="headerlink" href="#shifting-times-in-filename-templates" title="Permalink to this headline">¶</a></h4>
<p>Users can use the ‘shift’ keyword to adjust the time referenced in the filename template relative to the run time. For example, if the input files used contained data from 01Z on the date specified in the filename to 01Z on the following day. In this example, for a run at 00Z you want to use the file from the previous day and for the 01Z to 23Z runs you want to use the file that corresponds to the current day. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[filename_templates]
OBS_POINT_STAT_INPUT_TEMPLATE = {valid?fmt=%Y%m%d?shift=-3600}.ext
</pre></div>
</div>
<p>Running the above configuration at a valid time of 20190201_12Z will shift the valid time backwards by 1 hour (3600 seconds) resulting in 20190201_11Z and will substitute the current day into the template, giving a filename of 20190201.ext. Running at valid time 20190201_00Z, the shift will result in a file time of 20190131_23Z, so the filename will be 20190131.ext that is generated by the template.</p>
</div>
<div class="section" id="using-windows-to-find-valid-files">
<h4><span class="section-number">3.3.5.5. </span>Using Windows to find Valid Files<a class="headerlink" href="#using-windows-to-find-valid-files" title="Permalink to this headline">¶</a></h4>
<p>The [FCST/OBS]_FILE_WINDOW_[BEGIN/END] configuration variables can be used if the time information in the input data does not exactly line up with the run time but you still want to process the data. The default value of the file window begin and end variables are both 0 seconds. If both values are set to 0, METplus Wrappers will require that a file matching the template with the exact time requested exists. If either value is non-zero, METplus Wrappers will examine all of the files under the input directory that match the template, pull out the time information from the files, and use the file with the time closest to the run_time. For example, consider the following configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[config]
OBS_FILE_WINDOW_BEGIN = -7200
OBS_FILE_WINDOW_END = 7200

[dir]
OBS_GRID_STAT_INPUT_DIR = /my/grid_stat/input/obs

[filename_templates]
OBS_GRID_STAT_INPUT_TEMPLATE = {valid?fmt=%Y%m%d}/pre.{valid?fmt=%Y%m%d}_{valid?fmt=%H}.ext
</pre></div>
</div>
<div class="line-block">
<div class="line">For a run time of 20190201_00Z, and a set of files in the input directory that looks like this:</div>
<div class="line-block">
<div class="line">/my/grid_stat/input/obs/20190131/pre.20190131_22.ext</div>
<div class="line">/my/grid_stat/input/obs/20190131/pre.20190131_23.ext</div>
<div class="line">/my/grid_stat/input/obs/20190201/othertype.20190201_00.ext</div>
<div class="line">/my/grid_stat/input/obs/20190201/pre.20190201_01.ext</div>
<div class="line">/my/grid_stat/input/obs/20190201/pre.20190201_02.ext</div>
</div>
</div>
<p>The following behavior can be expected for each file:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The first file matches the template and the file time is within the window, so the filename and time difference relative to the valid time (7200 seconds, or 2 hours) is saved.</p></li>
<li><p>The second file matches the template, the file time is within the window, and the time difference is less than the closest file so the filename and time difference relative to the valid time (3600 seconds, or 1 hour) is saved.</p></li>
<li><p>The third file does not match the template and is ignored.</p></li>
<li><p>The fourth file matches the template and is within the time range, but it is the same distance away from the valid time as the closest file. GridStat only allows one file to be processed so it is ignored (PB2NC is currently the only METplus Wrapper that allows multiple files to be processed).</p></li>
<li><p>The fifth file matches the template but it is a further distance away from the closest file (7200 seconds versus 3600 seconds) so it is ignored.</p></li>
</ol>
</div></blockquote>
<p>Therefore, METplus Wrappers will use /my/grid_stat/input/obs/20190131/pre.20190131_23.ext as the input to grid_stat in this example.</p>
</div>
<div class="section" id="wrapper-specific-windows">
<h4><span class="section-number">3.3.5.6. </span>Wrapper Specific Windows<a class="headerlink" href="#wrapper-specific-windows" title="Permalink to this headline">¶</a></h4>
<p>A user may need to specify a different window on a wrapper-by-wrapper basis. If this is the case, you can override the file window values for each wrapper. Consider the following configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">PROCESS_LIST</span> <span class="o">=</span> <span class="n">PCPCombine</span><span class="p">,</span> <span class="n">GridStat</span><span class="p">,</span> <span class="n">EnsembleStat</span>
<span class="n">OBS_FILE_WINDOW_BEGIN</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">OBS_FILE_WINDOW_END</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">OBS_GRID_STAT_FILE_WINDOW_BEGIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1800</span>
<span class="n">OBS_GRID_STAT_FILE_WINDOW_END</span> <span class="o">=</span> <span class="mi">1800</span>
<span class="n">OBS_ENSEMBLE_STAT_FILE_WINDOW_END</span> <span class="o">=</span> <span class="mi">3600</span>
</pre></div>
</div>
<p>Using the above configuration, PCPCombine will use +/- 0 hours and require exact file times. GridStat will use -1800/+1800 for observation data and EnsembleStat will use -0/+3600 for observation data. <a class="reference internal" href="glossary.html#term-OBS_ENSEMBLE_STAT_FILE_WINDOW_BEGIN"><span class="xref std std-term">OBS_ENSEMBLE_STAT_FILE_WINDOW_BEGIN</span></a> was not set, so the EnsembleStat wrapper will use <a class="reference internal" href="glossary.html#term-OBS_FILE_WINDOW_BEGIN"><span class="xref std std-term">OBS_FILE_WINDOW_BEGIN</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="config-quick-start-example">
<h2><span class="section-number">3.4. </span>Config Quick Start Example<a class="headerlink" href="#config-quick-start-example" title="Permalink to this headline">¶</a></h2>
<p><strong>Simple Example Use Case</strong></p>
<ol class="arabic">
<li><p>Set up the configuration file:</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>Your METplus Wrappers install directory will hereafter be referred to as METplus_INSTALL</p></li>
<li><p>Create a user_system.conf file (wherever you wish, just make note of the path to where you saved it) and under the [dir] section, do the following:</p>
<blockquote>
<div><p>-set INPUT_BASE = /tmp/input</p>
<p>(or to some other directory that exists, as this use case does not use input data)</p>
<p>-set OUTPUT_BASE = /tmp/output</p>
<p>(or to some other directory that exists where you wish to direct your output)</p>
<p>-set MET_INSTALL_DIR = &lt;path/to/your/MET&gt;</p>
<p>where <em>&lt;path/to/your/MET&gt;</em> is the full path to your MET installation:</p>
<blockquote>
<div><p>e.g. /d1/projects/MET/met-9.0</p>
</div></blockquote>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
<li><p>Run the use case:</p>
<ol class="loweralpha">
<li><p>On your command line, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">master_metplus</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">METplus</span><span class="o">/</span><span class="n">parm</span><span class="o">/</span><span class="n">use_cases</span><span class="o">/</span><span class="n">met_tool_wrapper</span><span class="o">/</span><span class="n">Example</span><span class="o">/</span><span class="n">Example</span><span class="o">.</span><span class="n">conf</span> <span class="o">-</span><span class="n">c</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">user_system</span><span class="o">.</span><span class="n">conf</span>

<span class="o">*</span><span class="n">where</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">user_system</span><span class="o">.</span><span class="n">conf</span> <span class="n">indicates</span> <span class="n">the</span> <span class="n">location</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user_system</span><span class="o">.</span><span class="n">conf</span> <span class="n">file</span> <span class="n">you</span> <span class="n">created</span> <span class="n">earlier</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>When complete, you should see the following message printed to the screen upon successful completion: “INFO: METplus has successfully finished running.”
A <em>logs</em> directory with a log file will be created under the output directory you specified.
Additionally, a metplus_final.conf file is created and saved to the output directory.  It contains all the final values set by all your
METplus configuration files, including those from the METplus_INSTALL/parm/metplus_config directory.</p></li>
</ol>
</li>
</ol>
<p><strong>Track and Intensity Use Case with Sample Data</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Create a directory where you wish to store the sample data. Sample datasets are specific to each use case and are required in order to be able to run the use case.</p></li>
<li><p>Retrieve the sample data from the GitHub repository:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>In your browser, navigate to <a class="reference external" href="https://www.github.com/dtcenter/METplus/releases">https://www.github.com/dtcenter/METplus/releases</a></p></li>
<li><p>Locate the latest release</p></li>
<li><p>Expand the ‘Assets’ menu by clicking on the black triangle to the left of the word ‘Assets’</p></li>
<li><p>Click on the <em>sample_data-medium_range-x.y.tgz</em> link associated with that release, where x.y refers to the release number.</p></li>
<li><p>Save it to the directory you created above, hereafter referred to as INPUT_DATA_DIRECTORY</p></li>
<li><p>cd to your $INPUT_DATA_DIRECTORY and uncompress the tarball: <em>tar xvfz sample_data-medium_range-x.y.tgz</em> where x.y is replaced with the current release number.</p></li>
<li><p>when you perform a listing of the sample_data directory, the INPUT_DATA_DIRECTORY/model_applications/medium_range contains the data you will need for this use case</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Set up the configuration file:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Your METplus Wrappers install directory will hereafter be referred to as METplus_INSTALL</p></li>
<li><p>Verify that all the <em>&lt;/path/to&gt;</em> values are replaced with valid paths in the METplus_INSTALL/parm/metplus_config/metplus_data.conf and METplus_INSTALL/parm/metplus_config/metplus_system.conf files</p></li>
<li><p>One configuration file is used in this use case, Plotter_fcstGFS_obsGFS_RPlotting.conf to take cyclone track data, and using TCPairs which wraps the MET TC-Pairs tool (to match ADeck and BDeck cyclone tracks to generate matched pairs and error statistics). The TCMPRPlotter is then used (wraps the MET tool plot_tcmpr.R) to generate a mean and median plots for these matched pairs</p></li>
<li><p>In your editor, open the METplus_INSTALL/METplus/parm/use_cases/model_applications/tc_and_extra_tc/Plotter_fcstGFS_obsGFS_RPlotting.conf file and perform the following:</p></li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li><p>Under the [dir] section, add the following:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>OUTPUT_BASE to where you wish to save the output:  e.g. OUTPUT_BASE = path-to-your/output_dir</p></li>
<li><p>INPUT_BASE = INPUT_DATA_DIRECTORY/model_applications</p></li>
<li><p>MET_INSTALL_DIR = path-to-your/MET-install where path-to-your/MET-install is the full path where your MET installation resides</p></li>
<li><p>Verify that PROCESS_LIST, under the [conf] header/section is set to TCPairs, TCMPRPlotter. This instructs METplus Wrappers to run the TCPairs wrapper first (TC-Pairs) followed by the TCMPR plotter wrapper (plot_TCMPR.R).</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Save your changes and exit your editor</p></li>
</ol>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Run the use case:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Make sure you have set the following environment in your .cshrc (C Shell) or .bashrc (Bash):</p></li>
</ol>
<blockquote>
<div><ol class="arabic">
<li><p>csh: setenv RSCRIPTS_BASE $MET_BASE/scripts/Rscripts</p></li>
<li><p>bash: export RSCRIPTS_BASE=$MET_BASE/scripts/Rscripts</p></li>
<li><p>Refer to section 2.7 ‘Set up your environment’ in the <a class="reference internal" href="installation.html#install"><span class="std std-ref">Software Installation/Getting Started</span></a> chapter for the full instructions on setting up the rest of your environment</p></li>
<li><p>On your command line, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">master_metplus</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">c</span> <span class="n">parm</span><span class="o">/</span><span class="n">use_cases</span><span class="o">/</span><span class="n">model_applications</span><span class="o">/</span><span class="n">tc_and_extra_tc</span><span class="o">/</span><span class="n">Plotter_fcstGFS_obsGFS_RPlotting</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</li>
<li><p>When complete, you will have a log file in the output directory you specified, and under the tc_pairs directory you will see .tcst files under the 201412 subdirectory. These are the matched pairs created by the MET tool Tc-pairs and can be viewed in any text editor.</p></li>
<li><p>Plots are generated under the tcmpr_plots subdirectory in .png format. You should have the following plots which can be viewed by any graphics viewers such as ‘display’ on Linux/Unix hosts:</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>AMAX_WIND-BMAX_WIND_boxplot.png</p></li>
<li><p>AMAX_WIND-BMAX_WIND_mean.png</p></li>
<li><p>AMAX_WIND-BMAX_WIND_median.png</p></li>
<li><p>AMSLP-BMSLP_boxplot.png</p></li>
<li><p>AMSLP-BMSLP_mean.png</p></li>
<li><p>AMSLP-BMSLP_median.png</p></li>
<li><p>TK_ERR_boxplot.png</p></li>
<li><p>TK_ERR_mean.png</p></li>
<li><p>TK_ERR_median.png</p></li>
</ol>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="user-defined-config">
<h2><span class="section-number">3.5. </span>User Defined Config<a class="headerlink" href="#user-defined-config" title="Permalink to this headline">¶</a></h2>
<p>You can define your own custom config variables that will be set as environment variables when METplus is run. MET config files can read environment variables, so this is a good way to customize information that is read by those files. To create add a custom config variable, add a section to one of your METplus config files called [user_env_vars]. Under this header, add as many variables as you’d like. For example, if you added the following to your METplus config file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">user_env_vars</span><span class="p">]</span>
<span class="n">VAR_NAME</span> <span class="o">=</span> <span class="n">some_text_for_feb_1_1987_run</span>
</pre></div>
</div>
<p>and you added the following to a MET config file that is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>output_prefix = ${VAR_NAME}
</pre></div>
</div>
<p>then at run time, the MET application will be run with the configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_prefix</span> <span class="o">=</span> <span class="n">some_text_for_feb_1_1987_run</span>
</pre></div>
</div>
<p>You can also reference other variables in the METplus config file. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">config</span><span class="p">]</span>
<span class="n">INIT_BEG</span> <span class="o">=</span> <span class="mi">1987020104</span>

<span class="p">[</span><span class="n">user_env_vars</span><span class="p">]</span>
<span class="n">USE_CASE_TIME_ID</span> <span class="o">=</span> <span class="p">{</span><span class="n">INIT_BEG</span><span class="p">}</span>
</pre></div>
</div>
<p>This is the equivalent of calling (bash example shown):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export USE_CAST_TIME_ID=1987020104
</pre></div>
</div>
<p>on the command line at the beginning of your METplus run. You can access the variable in the MET config file with ${USE_CASE_TIME_ID}.</p>
<p><a class="reference internal" href="glossary.html"><span class="doc">METplus Configuration Glossary</span></a></p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="wrappers.html" class="btn btn-neutral float-right" title="4. Python Wrappers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="2. Software Installation/Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR/NCAR, NOAA, CSU/CIRA, and CU/CIRES.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
 
<script>var version_json_loc = "../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>