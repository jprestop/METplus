

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5.2.2.6. Surrogate Severe Calculation: PCPCombine, EnsembleStat, and RegridDataPlane &mdash; METplus 3.1 documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://dtcenter.github.io/METplus/latest/generated/model_applications/convection_allowing_models/EnsembleStat_fcstHRRR_fcstOnly_SurrogateSevere.html"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/theme_override.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/gallery-binder.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/gallery-dataframe.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="METplus 3.1 documentation" href="../../../index.html"/>
        <link rel="up" title="5.2. Model Applications" href="../index.html"/>
        <link rel="next" title="5.2.3.1. Grid-Stat and MODE: Sea Ice Validation" href="../cryosphere/GridStat_MODE_fcstIMS_obsNCEP_sea_ice.html"/>
        <link rel="prev" title="5.2.2.5. Point2Grid: Calculate Practically Perfect Probabilities" href="Point2Grid_obsLSR_ObsOnly_PracticallyPerfect.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> METplus
          

          
            
            <img src="../../../_static/METplus_logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  3.1
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">METplus Wrappers Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../Users_Guide/index.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/overview.html">1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/installation.html">2. Software Installation/Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/systemconfiguration.html">3. System Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/wrappers.html">4. Python Wrappers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../Users_Guide/usecases.html">5. METplus Use Cases</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../met_tool_wrapper/index.html">5.1. MET tools</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">5.2. Model Applications</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../index.html#climate">5.2.1. Climate</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html#convection-allowing-models">5.2.2. Convection Allowing Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#cryosphere">5.2.3. Cryosphere</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#medium-range">5.2.4. Medium Range</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#precipitation">5.2.5. Precipitation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#subseasonal-to-seasonal">5.2.6. Subseasonal to Seasonal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#space-weather">5.2.7. Space Weather</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index.html#tropical-cyclone-and-extra-tropical-cyclone">5.2.8. Tropical Cyclone and Extra Tropical Cyclone</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/references.html">6. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/quicksearch.html">7. METplus Quick Search for Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/glossary.html">8. METplus Configuration Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Users_Guide/index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../Contributors_Guide/index.html">Contributor’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">METplus</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../Users_Guide/index.html">User’s Guide</a> &raquo;</li>
        
          <li><a href="../../../Users_Guide/usecases.html"><span class="section-number">5. </span>METplus Use Cases</a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">5.2. </span>Model Applications</a> &raquo;</li>
        
      <li><span class="section-number">5.2.2.6. </span>Surrogate Severe Calculation: PCPCombine, EnsembleStat, and RegridDataPlane</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/generated/model_applications/convection_allowing_models/EnsembleStat_fcstHRRR_fcstOnly_SurrogateSevere.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<div class="sphx-glr-example-title section" id="surrogate-severe-calculation-pcpcombine-ensemblestat-and-regriddataplane">
<span id="sphx-glr-generated-model-applications-convection-allowing-models-ensemblestat-fcsthrrr-fcstonly-surrogatesevere-py"></span><h1><span class="section-number">5.2.2.6. </span>Surrogate Severe Calculation: PCPCombine, EnsembleStat, and RegridDataPlane<a class="headerlink" href="#surrogate-severe-calculation-pcpcombine-ensemblestat-and-regriddataplane" title="Permalink to this headline">¶</a></h1>
<p>model_applications/convection_allowing_model/EnsembleStat_fcstHRRR_fcstOnly_SurrogateSevere.conf</p>
<div class="section" id="scientific-objective">
<h2>Scientific Objective<a class="headerlink" href="#scientific-objective" title="Permalink to this headline">¶</a></h2>
<p>Run PCPCombine, EnsembleStat, and RegridDataPlane tools to create surrogate severe probability
forecasts (SSPFs) for a given date. SSPFs are a severe weather forecasting tool and is a techniqu
used by the Storm Prediction Center (SPC) as well as others. SSPFs are based on updraft helicity
(UH; UH = ∫z0 to zt (ω * ζ) dz) since certain thresholds of UH have been shown as good proxies for# severe weather. SSPFs can be thought of as the perfect model forecast. They are derived as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Regrid the maximum UH value over the 2-5km layer at each grid point to the NCEP 211 grid (dx = ~80km).</p></li>
<li><p>Create a binary mask of points that meet a given threshold of UH)</p></li>
<li><p>Convert the binary mask into a probability field by applying a Gaussian filter.</p></li>
</ol>
</div></blockquote>
<p>For more information, please reference Sobash et al. 2011 (<a class="reference external" href="https://journals.ametsoc.org/doi/full/10.1175/WAF-D-10-05046.1">https://journals.ametsoc.org/doi/full/10.1175/WAF-D-10-05046.1</a>).</p>
</div>
<div class="section" id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h2>
<p>There are two dates that can be used as input data for this use case 20190518 or 20200205.</p>
<ul class="simple">
<li><p>Input Data: HRRR data
- There should 24 grib2 files.
- Variable of interest: MXUPHL; the maximum updraft helicity
- Level: Z2000-5000; from 2 - 5km
- Format: grib2
- Projection: Lambert Conformal</p></li>
<li><p>Location: kiowa:/d1/projects/METplus/METplus_Data/model_applications/convection_allowing_models/surrogate_severe_calc/</p></li>
<li><p>Data Source: Originally received from Burkely Gallo at the Storm Prediction Center.</p></li>
</ul>
</div>
<div class="section" id="metplus-components">
<h2>METplus Components<a class="headerlink" href="#metplus-components" title="Permalink to this headline">¶</a></h2>
<p>This use case runs the PCPCombine, EnsembleStat, and RegridDataPlane MET tools.</p>
</div>
<div class="section" id="metplus-workflow">
<h2>METplus Workflow<a class="headerlink" href="#metplus-workflow" title="Permalink to this headline">¶</a></h2>
<p>This workflow loops over the data by process, meaning that each MET tool will run over all times
before moving onto the tool. PCPCombine is called first, followed by EnsembleStat,
and then, finally, RegridDataPlane.</p>
</div>
<div class="section" id="metplus-configuration">
<h2>METplus Configuration<a class="headerlink" href="#metplus-configuration" title="Permalink to this headline">¶</a></h2>
<p>METplus first loads all of the configuration files found in parm/metplus_config. Then, it loads
any configuration files passed to METplus by the command line with the -c option.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># HRRR Surrogate Severe Calculation</span>

<span class="o">[</span>config<span class="o">]</span>
<span class="c1"># time looping - options are INIT, VALID, RETRO, and REALTIME</span>
<span class="nv">LOOP_BY</span> <span class="o">=</span> INIT

<span class="c1"># Format of INIT_BEG and INIT_END</span>
<span class="nv">INIT_TIME_FMT</span> <span class="o">=</span> %Y%m%d%H

<span class="c1"># Start time for METplus run</span>
<span class="nv">INIT_BEG</span><span class="o">=</span><span class="m">2020020500</span>

<span class="c1"># End time for METplus run</span>
<span class="nv">INIT_END</span><span class="o">=</span><span class="m">2020020500</span>

<span class="c1"># Increment between METplus runs in seconds. Must be &gt;= 60</span>
<span class="nv">INIT_INCREMENT</span><span class="o">=</span><span class="m">86400</span>

<span class="c1"># list of forecast leads to process</span>
<span class="nv">LEAD_SEQ</span> <span class="o">=</span> <span class="m">36</span>

<span class="c1"># Options are times, processes</span>
<span class="c1"># times = run all items in the PROCESS_LIST for a single initialization</span>
<span class="c1"># time, then repeat until all times have been evaluated.</span>
<span class="c1"># processes = run each item in the PROCESS_LIST for all times</span>
<span class="c1">#   specified, then repeat for the next item in the PROCESS_LIST.</span>
<span class="nv">LOOP_ORDER</span> <span class="o">=</span> processes

<span class="c1"># List of applications to run</span>
<span class="nv">PROCESS_LIST</span> <span class="o">=</span> PCPCombine, EnsembleStat, RegridDataPlane

<span class="c1"># PCP_COMBINE (Step 1)</span>
<span class="c1"># run pcp_combine on forecast data</span>
<span class="nv">FCST_PCP_COMBINE_RUN</span> <span class="o">=</span> True

<span class="c1"># method to run pcp_combine on forecast data</span>
<span class="c1"># Options are ADD, SUM, SUBTRACT, and DERIVE</span>
<span class="nv">FCST_PCP_COMBINE_METHOD</span> <span class="o">=</span> DERIVE
<span class="nv">FCST_PCP_COMBINE_STAT_LIST</span> <span class="o">=</span> MAX

<span class="c1"># field name of 1 hr accumulation in forecast files</span>
<span class="nv">FCST_PCP_COMBINE_INPUT_ACCUMS</span> <span class="o">=</span> <span class="m">1</span>
<span class="nv">FCST_PCP_COMBINE_INPUT_NAMES</span> <span class="o">=</span> MXUPHL
<span class="nv">FCST_PCP_COMBINE_INPUT_LEVELS</span> <span class="o">=</span> Z2000-5000
<span class="nv">FCST_PCP_COMBINE_OUTPUT_NAME</span> <span class="o">=</span> MXUPHL_24
<span class="nv">FCST_PCP_COMBINE_OUTPUT_ACCUM</span> <span class="o">=</span> <span class="m">24</span>
<span class="nv">FCST_PCP_COMBINE_DERIVE_LOOKBACK</span> <span class="o">=</span> <span class="m">24</span>
<span class="nv">FCST_PCP_COMBINE_INPUT_DATATYPE</span> <span class="o">=</span> GRIB

<span class="c1">#ENSEMBLE_STAT (Steps 2 and 3)</span>
<span class="c1"># number of expected members for ensemble. Should correspond with the</span>
<span class="c1">#  number of items in the list for FCST_ENSEMBLE_STAT_INPUT_TEMPLATE</span>
<span class="nv">ENSEMBLE_STAT_N_MEMBERS</span> <span class="o">=</span> <span class="m">1</span>

<span class="c1"># ens.ens_thresh value in the MET config file</span>
<span class="c1"># threshold for ratio of valid files to expected files to allow app to run</span>
<span class="nv">ENSEMBLE_STAT_ENS_THRESH</span> <span class="o">=</span> <span class="m">1</span>.0

<span class="c1"># Used in the MET config file for: regrid to_grid field</span>
<span class="nv">ENSEMBLE_STAT_REGRID_TO_GRID</span> <span class="o">=</span> G211

<span class="nv">ENSEMBLE_STAT_CONFIG_FILE</span> <span class="o">=</span> <span class="o">{</span>CONFIG_DIR<span class="o">}</span>/EnsembleStatConfig_Surrogate_severe

<span class="nv">ENS_VAR1_NAME</span> <span class="o">=</span> <span class="o">{</span>FCST_PCP_COMBINE_OUTPUT_NAME<span class="o">}</span>
<span class="nv">ENS_VAR1_LEVELS</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>
<span class="nv">ENS_VAR1_THRESH</span> <span class="o">=</span> &gt;<span class="o">=</span><span class="m">14</span>.2, &gt;<span class="o">=</span><span class="m">19</span>.0, &gt;<span class="o">=</span><span class="m">26</span>.0, &gt;<span class="o">=</span><span class="m">38</span>.0, &gt;<span class="o">=</span><span class="m">61</span>.0


<span class="c1"># REGRID_DATA_PLANE (Step 4)</span>
<span class="c1"># Run regrid_data_plane on forecast data</span>
<span class="nv">FCST_REGRID_DATA_PLANE_RUN</span> <span class="o">=</span> True

<span class="c1"># If true, process each field individually and write a file for each</span>
<span class="c1"># If false, run once per run time passing in all fields specified</span>
<span class="nv">REGRID_DATA_PLANE_ONCE_PER_FIELD</span> <span class="o">=</span> False

<span class="c1"># Name of input field to process</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR1_INPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_24_A1_ENS_FREQ_ge14.2
<span class="nv">FCST_REGRID_DATA_PLANE_VAR2_INPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_24_A1_ENS_FREQ_ge19.0
<span class="nv">FCST_REGRID_DATA_PLANE_VAR3_INPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_24_A1_ENS_FREQ_ge26.0
<span class="nv">FCST_REGRID_DATA_PLANE_VAR4_INPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_24_A1_ENS_FREQ_ge38.0
<span class="nv">FCST_REGRID_DATA_PLANE_VAR5_INPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_24_A1_ENS_FREQ_ge61.0

<span class="c1"># Level of input field to process</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR1_INPUT_LEVEL</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR2_INPUT_LEVEL</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR3_INPUT_LEVEL</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR4_INPUT_LEVEL</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR5_INPUT_LEVEL</span> <span class="o">=</span> <span class="s2">&quot;(*,*)&quot;</span>

<span class="c1"># Name of output field to create</span>
<span class="nv">FCST_REGRID_DATA_PLANE_VAR1_OUTPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_prob_75
<span class="nv">FCST_REGRID_DATA_PLANE_VAR2_OUTPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_prob_80
<span class="nv">FCST_REGRID_DATA_PLANE_VAR3_OUTPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_prob_85
<span class="nv">FCST_REGRID_DATA_PLANE_VAR4_OUTPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_prob_90
<span class="nv">FCST_REGRID_DATA_PLANE_VAR5_OUTPUT_FIELD_NAME</span> <span class="o">=</span> MXUPHL_prob_95

<span class="c1"># Mask to use for regridding</span>
<span class="nv">REGRID_DATA_PLANE_VERIF_GRID</span> <span class="o">=</span> G211

<span class="c1"># Method to run regrid_data_plane, not setting this will default to NEAREST</span>
<span class="nv">REGRID_DATA_PLANE_METHOD</span> <span class="o">=</span> MAXGAUSS

<span class="c1"># Regridding width used in regrid_data_plane, not setting this will default to 1</span>
<span class="nv">REGRID_DATA_PLANE_WIDTH</span> <span class="o">=</span> <span class="m">1</span>

<span class="c1"># Set Gaussian dx value to add as command line argument - not added if unset or blank</span>
<span class="nv">REGRID_DATA_PLANE_GAUSSIAN_DX</span> <span class="o">=</span> <span class="m">81</span>.271

<span class="c1"># Set Gaussian filter radius value to add as command line argument - not added if unset or blank</span>
<span class="nv">REGRID_DATA_PLANE_GAUSSIAN_RADIUS</span> <span class="o">=</span> <span class="m">120</span>

<span class="o">[</span>dir<span class="o">]</span>

<span class="c1"># location of configuration files used by MET applications</span>
<span class="nv">CONFIG_DIR</span><span class="o">={</span>PARM_BASE<span class="o">}</span>/use_cases/model_applications/convection_allowing_models

<span class="c1"># input and output data directories for each application in PROCESS_LIST</span>
<span class="nv">FCST_PCP_COMBINE_INPUT_DIR</span> <span class="o">=</span> <span class="o">{</span>INPUT_BASE<span class="o">}</span>/model_applications/convection_allowing_models/surrogate_severe_calc
<span class="nv">FCST_PCP_COMBINE_OUTPUT_DIR</span> <span class="o">=</span> <span class="o">{</span>OUTPUT_BASE<span class="o">}</span>/convection_allowing_models/surrogate_severe_calc

<span class="nv">FCST_ENSEMBLE_STAT_INPUT_DIR</span> <span class="o">=</span> <span class="o">{</span>FCST_PCP_COMBINE_OUTPUT_DIR<span class="o">}</span>
<span class="nv">ENSEMBLE_STAT_OUTPUT_DIR</span> <span class="o">=</span> <span class="o">{</span>FCST_PCP_COMBINE_OUTPUT_DIR<span class="o">}</span>

<span class="nv">FCST_REGRID_DATA_PLANE_INPUT_DIR</span> <span class="o">=</span> <span class="o">{</span>FCST_PCP_COMBINE_OUTPUT_DIR<span class="o">}</span>
<span class="nv">FCST_REGRID_DATA_PLANE_OUTPUT_DIR</span> <span class="o">=</span> <span class="o">{</span>FCST_PCP_COMBINE_OUTPUT_DIR<span class="o">}</span>

<span class="o">[</span>filename_templates<span class="o">]</span>
<span class="c1"># format of filenames</span>
<span class="c1"># Input HRRR</span>
<span class="nv">FCST_PCP_COMBINE_INPUT_TEMPLATE</span> <span class="o">=</span> <span class="o">{</span>init?fmt<span class="o">=</span>%Y%m%d<span class="o">}</span>/hrrr_ncep_<span class="o">{</span>init?fmt<span class="o">=</span>%Y%m%d%H<span class="o">}</span>f<span class="o">{</span>lead?fmt<span class="o">=</span>%HHH<span class="o">}</span>.grib2
<span class="nv">FCST_PCP_COMBINE_OUTPUT_TEMPLATE</span> <span class="o">=</span> <span class="o">{</span>init?fmt<span class="o">=</span>%Y%m%d<span class="o">}</span>/hrrr_ncep_<span class="o">{</span>init?fmt<span class="o">=</span>%Y%m%d%H<span class="o">}</span>f<span class="o">{</span>lead?fmt<span class="o">=</span>%HHH<span class="o">}</span>.nc

<span class="c1"># To enemble_stat</span>
<span class="nv">FCST_ENSEMBLE_STAT_INPUT_TEMPLATE</span> <span class="o">=</span> <span class="o">{</span>FCST_PCP_COMBINE_OUTPUT_TEMPLATE<span class="o">}</span>

<span class="c1"># To regrid_data_plane</span>
<span class="nv">FCST_REGRID_DATA_PLANE_INPUT_TEMPLATE</span> <span class="o">=</span> ensemble_stat_<span class="o">{</span>valid?fmt<span class="o">=</span>%Y%m%d<span class="o">}</span>_120000V_ens.nc
<span class="nv">FCST_REGRID_DATA_PLANE_OUTPUT_TEMPLATE</span> <span class="o">=</span> surrogate_severe_<span class="o">{</span>init?fmt<span class="o">=</span>%Y%m%d<span class="o">}</span>_<span class="o">{</span>lead?fmt<span class="o">=</span>%HHH<span class="o">}</span>V_regrid.nc
</pre></div>
</div>
</div>
<div class="section" id="met-configuration">
<h2>MET Configuration<a class="headerlink" href="#met-configuration" title="Permalink to this headline">¶</a></h2>
<p>METplus sets environment variables based on the values in the METplus configuration file.
These variables are referenced in the MET configuration file. <strong>YOU SHOULD NOT SET ANY OF THESE ENVIRONMENT VARIABLES YOURSELF! THEY WILL BE OVERWRITTEN BY METPLUS WHEN IT CALLS THE MET TOOLS!</strong> If there is a setting in the MET configuration file that is not controlled by an environment variable, you can add additional environment variables to be set only within the METplus environment using the [user_env_vars] section of the METplus configuration files. See the ‘User Defined Config’ section on the ‘System Configuration’ page of the METplus User’s Guide for more information.</p>
<p><strong>EnsembleStatConfig_Surrogate_severe</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>////////////////////////////////////////////////////////////////////////////////
//
// Ensemble-Stat configuration file.
//
// For additional information, see the MET_BASE/config/README file.
//
////////////////////////////////////////////////////////////////////////////////

//
// Output model name to be written
//
<span class="nv">model</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">MODEL</span><span class="si">}</span><span class="s2">_ens&quot;</span><span class="p">;</span>

//
// Output description to be written
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;obs.field&quot;</span> entry
//
<span class="nv">desc</span> <span class="o">=</span> <span class="s2">&quot;NA&quot;</span><span class="p">;</span>

//
// Output observation <span class="nb">type</span> to be written
//
<span class="nv">obtype</span> <span class="o">=</span> <span class="s2">&quot;ANALYS&quot;</span><span class="p">;</span>

////////////////////////////////////////////////////////////////////////////////

//
// Verification grid
//
<span class="nv">regrid</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">to_grid</span>    <span class="o">=</span> <span class="si">${</span><span class="nv">REGRID_TO_GRID</span><span class="si">}</span><span class="p">;</span>
   <span class="nv">method</span>     <span class="o">=</span> MAX<span class="p">;</span>
   <span class="nv">width</span>      <span class="o">=</span> <span class="m">27</span><span class="p">;</span>
   <span class="nv">vld_thresh</span> <span class="o">=</span> <span class="m">0</span>.0<span class="p">;</span>
   <span class="nv">shape</span>      <span class="o">=</span> SQUARE<span class="p">;</span>
   <span class="nv">censor_thresh</span> <span class="o">=</span> <span class="o">[==</span>-9999<span class="o">]</span><span class="p">;</span>
   <span class="nv">censor_val</span>    <span class="o">=</span> <span class="o">[</span><span class="m">0</span>.0<span class="o">]</span><span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;field&quot;</span> entry
//
<span class="nv">censor_thresh</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="nv">censor_val</span>    <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="nv">cat_thresh</span>    <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="nv">nc_var_str</span>    <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

////////////////////////////////////////////////////////////////////////////////

//
// Ensemble product fields to be processed
//
<span class="nv">ens</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">ens_thresh</span> <span class="o">=</span> <span class="si">${</span><span class="nv">ENS_THRESH</span><span class="si">}</span><span class="p">;</span>
   <span class="nv">vld_thresh</span> <span class="o">=</span> <span class="m">1</span>.0<span class="p">;</span>

   <span class="nv">field</span> <span class="o">=</span> <span class="o">[</span> <span class="si">${</span><span class="nv">ENS_FIELD</span><span class="si">}</span>  <span class="o">]</span><span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Neighborhood ensemble probabilities
//
<span class="nv">nbrhd_prob</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">width</span>      <span class="o">=</span> <span class="o">[</span> <span class="m">5</span> <span class="o">]</span><span class="p">;</span>
   <span class="nv">shape</span>      <span class="o">=</span> CIRCLE<span class="p">;</span>
   <span class="nv">vld_thresh</span> <span class="o">=</span> <span class="m">0</span>.0<span class="p">;</span>
<span class="o">}</span>

//
// NMEP smoothing methods
//
<span class="nv">nmep_smooth</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">vld_thresh</span>      <span class="o">=</span> <span class="m">0</span>.0<span class="p">;</span>
   <span class="nv">shape</span>           <span class="o">=</span> CIRCLE<span class="p">;</span>
   <span class="nv">gaussian_dx</span>     <span class="o">=</span> <span class="m">81</span>.27<span class="p">;</span>
   <span class="nv">gaussian_radius</span> <span class="o">=</span> <span class="m">120</span><span class="p">;</span>
   <span class="nb">type</span> <span class="o">=</span> <span class="o">[</span>
      <span class="o">{</span>
         <span class="nv">method</span> <span class="o">=</span> GAUSSIAN<span class="p">;</span>
         <span class="nv">width</span>  <span class="o">=</span> <span class="m">1</span><span class="p">;</span>
      <span class="o">}</span>
   <span class="o">]</span><span class="p">;</span>
<span class="o">}</span>


////////////////////////////////////////////////////////////////////////////////

<span class="nv">cnt_thresh</span>  <span class="o">=</span> <span class="o">[</span> NA <span class="o">]</span><span class="p">;</span>
<span class="nv">cnt_logic</span>   <span class="o">=</span> UNION<span class="p">;</span>
<span class="nv">wind_thresh</span> <span class="o">=</span> <span class="o">[</span> NA <span class="o">]</span><span class="p">;</span>
<span class="nv">wind_logic</span>  <span class="o">=</span> UNION<span class="p">;</span>

//
// Forecast and observation fields to be verified
//
<span class="nv">fcst</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">field</span> <span class="o">=</span> <span class="o">[</span> <span class="si">${</span><span class="nv">FCST_FIELD</span><span class="si">}</span>  <span class="o">]</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>

//
// Ensemble bin sizes
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;obs.field&quot;</span> entry
//
<span class="nv">obs</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">field</span> <span class="o">=</span> <span class="o">[</span> <span class="si">${</span><span class="nv">OBS_FIELD</span><span class="si">}</span>   <span class="o">]</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
<span class="nv">obs</span> <span class="o">=</span> <span class="o">{</span> <span class="nv">wind_thresh</span> <span class="o">=</span> &gt;2.572<span class="p">;</span> <span class="o">}</span><span class="p">;</span>

////////////////////////////////////////////////////////////////////////////////

//
// Point observation filtering options
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;obs.field&quot;</span> entry
//
<span class="nv">message_type</span>       <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;ADPSFC&quot;</span> <span class="o">]</span><span class="p">;</span>
<span class="nv">sid_exc</span>            <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="nv">obs_thresh</span>         <span class="o">=</span> <span class="o">[</span> NA <span class="o">]</span><span class="p">;</span>
<span class="nv">obs_quality</span>        <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="nv">duplicate_flag</span>     <span class="o">=</span> UNIQUE<span class="p">;</span>
<span class="nv">obs_summary</span>        <span class="o">=</span> NONE<span class="p">;</span>
<span class="nv">obs_perc_value</span>     <span class="o">=</span> <span class="m">50</span><span class="p">;</span>
<span class="nv">skip_const</span>         <span class="o">=</span> TRUE<span class="p">;</span>

//
// Observation error options
// Set dist_type to NONE to use the observation error table instead
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;obs.field&quot;</span> entry
//
<span class="nv">obs_error</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">flag</span>             <span class="o">=</span> TRUE<span class="p">;</span>    // TRUE or FALSE
   <span class="nv">dist_type</span>        <span class="o">=</span> NONE<span class="p">;</span>    // Distribution <span class="nb">type</span>
   <span class="nv">dist_parm</span>        <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>      // Distribution parameters
   <span class="nv">inst_bias_scale</span>  <span class="o">=</span> <span class="m">1</span>.0<span class="p">;</span>     // Instrument bias scale adjustment
   <span class="nv">inst_bias_offset</span> <span class="o">=</span> <span class="m">0</span>.0<span class="p">;</span>     // Instrument bias offset adjustment
   <span class="nv">min</span>              <span class="o">=</span> NA<span class="p">;</span>      // Valid range of data
   <span class="nv">max</span>              <span class="o">=</span> NA<span class="p">;</span>
<span class="o">}</span>

//
// Mapping of message <span class="nb">type</span> group name to comma-separated list of values.
//
<span class="nv">message_type_group_map</span> <span class="o">=</span> <span class="o">[</span>
   <span class="o">{</span> <span class="nv">key</span> <span class="o">=</span> <span class="s2">&quot;SURFACE&quot;</span><span class="p">;</span> <span class="nv">val</span> <span class="o">=</span> <span class="s2">&quot;ADPSFC,SFCSHP,MSONET&quot;</span><span class="p">;</span>               <span class="o">}</span>,
   <span class="o">{</span> <span class="nv">key</span> <span class="o">=</span> <span class="s2">&quot;ANYAIR&quot;</span><span class="p">;</span>  <span class="nv">val</span> <span class="o">=</span> <span class="s2">&quot;AIRCAR,AIRCFT&quot;</span><span class="p">;</span>                      <span class="o">}</span>,
   <span class="o">{</span> <span class="nv">key</span> <span class="o">=</span> <span class="s2">&quot;ANYSFC&quot;</span><span class="p">;</span>  <span class="nv">val</span> <span class="o">=</span> <span class="s2">&quot;ADPSFC,SFCSHP,ADPUPA,PROFLR,MSONET&quot;</span><span class="p">;</span> <span class="o">}</span>,
   <span class="o">{</span> <span class="nv">key</span> <span class="o">=</span> <span class="s2">&quot;ONLYSF&quot;</span><span class="p">;</span>  <span class="nv">val</span> <span class="o">=</span> <span class="s2">&quot;ADPSFC,SFCSHP&quot;</span><span class="p">;</span>                      <span class="o">}</span>
<span class="o">]</span><span class="p">;</span>

//
// Ensemble bin sizes
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;obs.field&quot;</span> entry
//
<span class="nv">ens_ssvar_bin_size</span> <span class="o">=</span> <span class="m">1</span>.0<span class="p">;</span>
<span class="nv">ens_phist_bin_size</span> <span class="o">=</span> <span class="m">0</span>.05<span class="p">;</span>

////////////////////////////////////////////////////////////////////////////////

//
// Climatology data
//
<span class="nv">climo_mean</span> <span class="o">=</span> <span class="o">{</span>

   <span class="nv">file_name</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
   <span class="nv">field</span>     <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>

   <span class="nv">regrid</span> <span class="o">=</span> <span class="o">{</span>
      <span class="nv">method</span>     <span class="o">=</span> NEAREST<span class="p">;</span>
      <span class="nv">width</span>      <span class="o">=</span> <span class="m">1</span><span class="p">;</span>
      <span class="nv">vld_thresh</span> <span class="o">=</span> <span class="m">0</span>.5<span class="p">;</span>
      <span class="nv">shape</span>      <span class="o">=</span> SQUARE<span class="p">;</span>
   <span class="o">}</span>

   <span class="nv">time_interp_method</span> <span class="o">=</span> DW_MEAN<span class="p">;</span>
   <span class="nv">day_interval</span>       <span class="o">=</span> <span class="m">31</span><span class="p">;</span>
   <span class="nv">hour_interval</span>      <span class="o">=</span> <span class="m">6</span><span class="p">;</span>
<span class="o">}</span>

<span class="nv">climo_stdev</span> <span class="o">=</span> climo_mean<span class="p">;</span>
<span class="nv">climo_stdev</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">file_name</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="o">}</span>

//
// May be <span class="nb">set</span> separately in each <span class="s2">&quot;obs.field&quot;</span> entry
//
<span class="nv">climo_cdf</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">cdf_bins</span>    <span class="o">=</span> <span class="m">1</span><span class="p">;</span>
   <span class="nv">center_bins</span> <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">write_bins</span>  <span class="o">=</span> TRUE<span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Point observation <span class="nb">time</span> window
//
<span class="nv">obs_window</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">beg</span> <span class="o">=</span> <span class="si">${</span><span class="nv">OBS_WINDOW_BEGIN</span><span class="si">}</span><span class="p">;</span>
   <span class="nv">end</span> <span class="o">=</span> <span class="si">${</span><span class="nv">OBS_WINDOW_END</span><span class="si">}</span><span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Verification masking regions
//
<span class="nv">mask</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">grid</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
   <span class="nv">poly</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
   <span class="nv">sid</span>  <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
   <span class="nv">llpnt</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Confidence interval settings
//
<span class="nv">ci_alpha</span>  <span class="o">=</span> <span class="o">[</span> <span class="m">0</span>.01 <span class="o">]</span><span class="p">;</span> 

////////////////////////////////////////////////////////////////////////////////

//
// Interpolation methods
//
<span class="nv">interp</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">field</span>      <span class="o">=</span> NONE<span class="p">;</span>
   <span class="nb">type</span>       <span class="o">=</span> <span class="o">[</span> <span class="o">]</span><span class="p">;</span>
   <span class="nv">vld_thresh</span> <span class="o">=</span> <span class="m">1</span>.0<span class="p">;</span>
   <span class="nv">shape</span>  <span class="o">=</span> SQUARE<span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Statistical output types
//
<span class="nv">output_flag</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">ecnt</span>  <span class="o">=</span> NONE<span class="p">;</span>
   <span class="nv">rhist</span> <span class="o">=</span> NONE<span class="p">;</span>
   <span class="nv">phist</span> <span class="o">=</span> NONE<span class="p">;</span>
   <span class="nv">orank</span> <span class="o">=</span> NONE<span class="p">;</span>
   <span class="nv">ssvar</span> <span class="o">=</span> NONE<span class="p">;</span>
   <span class="nv">relp</span>  <span class="o">=</span> NONE<span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Ensemble product output types
//
<span class="nv">ensemble_flag</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nv">latlon</span>    <span class="o">=</span> TRUE<span class="p">;</span>
   <span class="nv">mean</span>      <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">stdev</span>     <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">minus</span>     <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">plus</span>      <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">min</span>       <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">max</span>       <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">range</span>     <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">vld_count</span> <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">frequency</span> <span class="o">=</span> TRUE<span class="p">;</span>
   <span class="nv">nep</span>       <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">nmep</span>      <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">rank</span>      <span class="o">=</span> FALSE<span class="p">;</span>
   <span class="nv">weight</span>    <span class="o">=</span> FALSE<span class="p">;</span>
<span class="o">}</span>

////////////////////////////////////////////////////////////////////////////////

//
// Random number generator
//
<span class="nv">rng</span> <span class="o">=</span> <span class="o">{</span>
   <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;mt19937&quot;</span><span class="p">;</span>
   <span class="nv">seed</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">;</span>
<span class="o">}</span>


////////////////////////////////////////////////////////////////////////////////

<span class="nv">grid_weight_flag</span> <span class="o">=</span> NONE<span class="p">;</span>
<span class="nv">output_prefix</span>    <span class="o">=</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">OUTPUT_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span>
//version          <span class="o">=</span> <span class="s2">&quot;V9.0&quot;</span><span class="p">;</span>

////////////////////////////////////////////////////////////////////////////////
</pre></div>
</div>
<dl class="simple">
<dt>See the following file for more information about the environment variables set in this configuration file:</dt><dd><p>parm/use_cases/met_tool_wrapper/EnsembleStat/EnsembleStat.py</p>
</dd>
</dl>
</div>
<div class="section" id="running-metplus">
<h2>Running METplus<a class="headerlink" href="#running-metplus" title="Permalink to this headline">¶</a></h2>
<p>The command to run this use case is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>master_metplus.py -c /path/to/METplus/parm/use_cases/model_applications/convection_allowing_models/EnsembleStat_fcstHRRR_fcstOnly_SurrogateSevere.conf
</pre></div>
</div>
</div>
<div class="section" id="expected-output">
<h2>Expected Output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># A successful run of this use case will output the following to the screen and logfile::</span>
<span class="c1">#</span>
<span class="c1">#    INFO: METplus has successfully finished runing.</span>
<span class="c1">#</span>
<span class="c1"># A successful run will have the following output files in the location defined by {OUTPUT_BASE}, which</span>
<span class="c1"># is located in the metplus_system.conf configuration file located in /path/to/METplus/parm/metplus_config.</span>
<span class="c1"># This list of files should be found for every time run through METplus. Using the output for 20190518 as an example.</span>
<span class="c1">#</span>
<span class="c1"># **PCPCombine output**:</span>
<span class="c1">#</span>
<span class="c1"># * 20190518/hrrr_ncep_2019051800f036.nc</span>
<span class="c1">#</span>
<span class="c1"># **EnsembleStat output**:</span>
<span class="c1">#</span>
<span class="c1"># * ensemble_stat_20190519_120000V_ens.nc</span>
<span class="c1">#</span>
<span class="c1"># **RegridDataPlane output**:</span>
<span class="c1">#</span>
<span class="c1"># * surrogate_severe_20190518_036V_regrid.nc</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="section" id="keywords">
<h2>Keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h2>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PCPCombineUseCase, EnsembleStatUseCase, RegridDataPlaneUseCase</p>
</div>

<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-model-applications-convection-allowing-models-ensemblestat-fcsthrrr-fcstonly-surrogatesevere-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">

</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">

</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cryosphere/GridStat_MODE_fcstIMS_obsNCEP_sea_ice.html" class="btn btn-neutral float-right" title="5.2.3.1. Grid-Stat and MODE: Sea Ice Validation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Point2Grid_obsLSR_ObsOnly_PracticallyPerfect.html" class="btn btn-neutral" title="5.2.2.5. Point2Grid: Calculate Practically Perfect Probabilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR/NCAR, NOAA, CSU/CIRA, and CU/CIRES.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
 
<script>var version_json_loc = "../../../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>